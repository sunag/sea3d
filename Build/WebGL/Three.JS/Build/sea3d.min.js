/** SEA3D (C) Sunag Entertainment - http://www.sunag.com.br/ */

var SEA3D={VERSION:16590,REVISION:3};console.log("SEA3D v"+SEA3D.VERSION+" r"+SEA3D.REVISION);SEA3D.Timer=function(){this.time=this.start=this.getTime()};SEA3D.Timer.prototype.getDeltaTime=function(){return this.getTime()-this.time};SEA3D.Timer.prototype.getTime=function(){return(new Date).getTime()};SEA3D.Timer.prototype.getElapsedTime=function(){return this.getTime()-this.start};SEA3D.Timer.prototype.update=function(){this.time=this.getTime()};
SEA3D.Stream=function(a){this.position=0;this.set(a||new Uint8Array)};SEA3D.Stream.bufferToBase64=function(a){for(var b=0,c=a.length,d="";b<c;)d+=String.fromCharCode(a[b++]);return window.btoa(d)};SEA3D.Stream.prototype.TWOeN23=Math.pow(2,-23);SEA3D.Stream.prototype.TWOeN52=Math.pow(2,-52);SEA3D.Stream.prototype.pow=Math.pow;SEA3D.Stream.prototype.set=function(a){this.buffer=a;this.length=a.length};SEA3D.Stream.prototype.readByte=function(){return this.buffer[this.position++]<<24>>24};
SEA3D.Stream.prototype.readUByte=function(){return this.buffer[this.position++]};SEA3D.Stream.prototype.readUBytes=function(a){for(var b=new Uint8Array(a),c=0;c<a;++c)b[c]=this.buffer[this.position++];return b};SEA3D.Stream.prototype.readBool=function(){return 0!=this.readUByte()};SEA3D.Stream.prototype.readShort=function(){var a=this.readUShort();return a>Math.pow(2,15)-1?a-Math.pow(2,16):a};SEA3D.Stream.prototype.readUShort=function(){return this.readUByte()|this.readUByte()<<8};
SEA3D.Stream.prototype.readUInt24=function(){return this.readUByte()|this.readUByte()<<8|this.readUByte()<<16};SEA3D.Stream.prototype.readUInt=function(){return this.readUByte()|this.readUByte()<<8|this.readUByte()<<16|this.readUByte()<<24};SEA3D.Stream.prototype.readUInteger=function(){var a=this.readUByte(),b=a&127;0!=(a&128)&&(a=this.readUByte(),b|=(a&127)<<7,0!=(a&128)&&(a=this.readUByte(),b|=(a&127)<<13));return b};
SEA3D.Stream.prototype.readFloat=function(){var a=this.readUByte(),b=this.readUByte(),c=this.readUByte(),d=this.readUByte(),e=(d<<1&255|c>>7)-127,a=(c&127)<<16|b<<8|a;return 0==a&&-127==e?0:(1-(d>>7<<1))*(1+this.TWOeN23*a)*this.pow(2,e)};SEA3D.Stream.prototype.readVector2=function(){return{x:this.readFloat(),y:this.readFloat()}};SEA3D.Stream.prototype.readVector3=function(){return{x:this.readFloat(),y:this.readFloat(),z:this.readFloat()}};
SEA3D.Stream.prototype.readVector4=function(){return{x:this.readFloat(),y:this.readFloat(),z:this.readFloat(),w:this.readFloat()}};
SEA3D.Stream.prototype.readMatrix=function(){var a=new Float32Array(16);a[0]=this.readFloat();a[1]=this.readFloat();a[2]=this.readFloat();a[3]=0;a[4]=this.readFloat();a[5]=this.readFloat();a[6]=this.readFloat();a[7]=0;a[8]=this.readFloat();a[9]=this.readFloat();a[10]=this.readFloat();a[11]=0;a[12]=this.readFloat();a[13]=this.readFloat();a[14]=this.readFloat();a[15]=1;return a};SEA3D.Stream.prototype.readUTF=function(a){return String.fromCharCode.apply(null,new Uint16Array(this.readUBytes(a)))};
SEA3D.Stream.prototype.readExt=function(){return this.readUTF(4).replace(/\0/g,"")};SEA3D.Stream.prototype.readUTF8=function(){return this.readUTF(this.readUByte())};SEA3D.Stream.prototype.readBlendMode=function(){return SEA3D.DataTable.BLEND_MODE[this.readUByte()]};SEA3D.Stream.prototype.toBase64=function(){return SEA3D.Stream.bufferToBase64(this.data)};
SEA3D.Stream.prototype.append=function(a){var b=new Uint8Array(this.data.byteLength+a.byteLength);b.set(new Uint8Array(this.data),0);b.set(new Uint8Array(a),this.data.byteLength);this.data=b};SEA3D.Stream.prototype.concat=function(a,b){return new SEA3D.Stream(this.buffer.subarray(a,a+b))};SEA3D.Stream.prototype.bytesAvailable=function(){return this.length-this.position};
SEA3D.DataTable={NONE:0,BOOLEAN:1,BYTE:2,UBYTE:3,SHORT:4,USHORT:5,INT24:6,UINT24:7,INT:8,UINT:9,FLOAT:10,DOUBLE:11,DECIMAL:12,VECTOR3D:74,VECTOR4D:106,STRING_TINY:128,STRING_SHORT:129,STRING_LONG:130};SEA3D.DataTable.BLEND_MODE="normal add subtract multiply dividing alpha screen darken overlay colorburn linearburn lighten colordodge lineardodge softlight hardlight pinlight spotlight spotlightblend hardmix average difference exclusion hue saturation color value".split(" ");
SEA3D.DataTable.INTERPOLATION_TABLE="normal linear sine.in sine.out sine.inout cubic.in cubic.out cubic.inout quint.in quint.out quint.inout circ.in circ.out circ.inout back.in back.out back.inout quad.in quad.out quad.inout quart.in quart.out quart.inout expo.in expo.out expo.inout elastic.in elastic.out elastic.inout bounce.in bounce.out bounce.inout".split(" ");SEA3D.DataTable.readObject=function(a){SEA3D.DataTable.readToken(a.readUByte(),a)};
SEA3D.DataTable.readToken=function(a,b){switch(a){case SEA3D.DataTable.BOOLEAN:return b.readBool();case SEA3D.DataTable.UBYTE:return b.readUByte();case SEA3D.DataTable.USHORT:return b.readUShort();case SEA3D.DataTable.UINT24:return b.readUInt24();case SEA3D.DataTable.UINT:return b.readUInt();case SEA3D.DataTable.FLOAT:return b.readFloat();case SEA3D.DataTable.VECTOR3D:return b.readVector3();case SEA3D.DataTable.VECTOR4D:return b.readVector4();case SEA3D.DataTable.STRING_TINY:return b.readUTF8()}return null};
SEA3D.DataTable.readVector=function(a,b,c,d,e){var g=SEA3D.DataTable.sizeOf(a);e*=g;d=e+d*g;switch(a){case SEA3D.DataTable.BOOLEAN:for(;e<d;)c[e++]=b.readBool()?1:0;break;case SEA3D.DataTable.UBYTE:for(;e<d;)c[e++]=b.readUByte();break;case SEA3D.DataTable.USHORT:for(;e<d;)c[e++]=b.readUShort();break;case SEA3D.DataTable.UINT24:for(;e<d;)c[e++]=b.readUInt24();break;case SEA3D.DataTable.UINT:for(;e<d;)c[e++]=b.readUInt();break;case SEA3D.DataTable.FLOAT:for(;e<d;)c[e++]=b.readFloat();break;case SEA3D.DataTable.VECTOR3D:for(;e<
d;)c[e++]=b.readFloat(),c[e++]=b.readFloat(),c[e++]=b.readFloat();break;case SEA3D.DataTable.VECTOR4D:for(;e<d;)c[e++]=b.readFloat(),c[e++]=b.readFloat(),c[e++]=b.readFloat(),c[e++]=b.readFloat()}};SEA3D.DataTable.sizeOf=function(a){return 0==a?0:1<=a&&31>=a?1:32<=a&&63>=a?2:64<=a&&95>=a?3:96<=a&&125>=a?4:-1};SEA3D.Math={DEGREES:180/Math.PI,RADIANS:Math.PI/180};SEA3D.Math.angle=function(a){var b=0>a;a=(b?-a:a)%360;180<a&&(a=-180+(a-180));return b?-a:a};
SEA3D.Math.lerpAngle=function(a,b,c){180<Math.abs(a-b)&&(b=a>b?b+360:b-360);return SEA3D.Math.angle(a+(b-a)*c)};SEA3D.Math.lerpColor=function(a,b,c){var d=a>>24&255,e=a>>16&255,g=a>>8&255;a&=255;e+=((b>>16&255)-e)*c;g+=((b>>8&255)-g)*c;a+=((b&255)-a)*c;return d+((b>>24&255)-d)*c<<24|e<<16|g<<8|a};SEA3D.Math.lerp=function(a,b,c){return a+(b-a)*c};SEA3D.Math.lerp1x=function(a,b,c){a[0]+=(b[0]-a[0])*c};SEA3D.Math.lerp3x=function(a,b,c){a[0]+=(b[0]-a[0])*c;a[1]+=(b[1]-a[1])*c;a[2]+=(b[2]-a[2])*c};
SEA3D.Math.lerpAng1x=function(a,b,c){a[0]=SEA3D.Math.lerpAngle(a[0],b[0],c)};SEA3D.Math.lerpColor1x=function(a,b,c){a[0]=SEA3D.Math.lerpColor(a[0],b[0],c)};SEA3D.Math.lerpQuat4x=function(a,b,c){var d=a[0],e=a[1],g=a[2],h=a[3],f=b[0],k=b[1],l=b[2];b=b[3];0>d*f+e*k+g*l+h*b&&(f=-f,k=-k,l=-l,b=-b);d+=c*(f-d);e+=c*(k-e);g+=c*(l-g);c=h+c*(b-h);h=1/Math.sqrt(c*c+d*d+e*e+g*g);a[0]=d*h;a[1]=e*h;a[2]=g*h;a[3]=c*h};SEA3D.AnimationBlendMethod={LINEAR:"linear",EASING:"easing"};
SEA3D.AnimationFrame=function(){this.data=[0,0,0,0]};SEA3D.AnimationFrame.prototype.toVector=function(){return{x:this.data[0],y:this.data[1],z:this.data[2],w:this.data[3]}};SEA3D.AnimationFrame.prototype.toAngles=function(a){var b=this.data[0],c=this.data[1],d=this.data[2],e=this.data[3],g=2*(e*c-d*b);-1>g?g=-1:1<g&&(g=1);return{x:Math.atan2(2*(e*b+c*d),1-2*(b*b+c*c))*a,y:Math.asin(g)*a,z:Math.atan2(2*(e*d+b*c),1-2*(c*c+d*d))*a}};SEA3D.AnimationFrame.prototype.toEuler=function(){return this.toAngles(SEA3D.Math.DEGREES)};
SEA3D.AnimationFrame.prototype.toRadians=function(){return this.toAngles(1)};SEA3D.AnimationFrame.prototype.setX=function(a){this.data[0]=a};SEA3D.AnimationFrame.prototype.getX=function(){return this.data[0]};SEA3D.AnimationFrame.prototype.setY=function(a){this.data[1]=a};SEA3D.AnimationFrame.prototype.getY=function(){return this.data[1]};SEA3D.AnimationFrame.prototype.setZ=function(a){this.data[2]=a};SEA3D.AnimationFrame.prototype.getZ=function(){return this.data[2]};
SEA3D.AnimationFrame.prototype.setW=function(a){this.data[3]=a};SEA3D.AnimationFrame.prototype.getW=function(){return this.data[3]};SEA3D.AnimationData=function(a,b,c,d){this.kind=a;this.type=b;this.blockLength=SEA3D.DataTable.sizeOf(b);this.data=c;this.offset=void 0==d?0:d;switch(this.blockLength){case 1:this.getData=this.getData1x;break;case 2:this.getData=this.getData2x;break;case 3:this.getData=this.getData3x;break;case 4:this.getData=this.getData4x}};
SEA3D.AnimationData.prototype.getData1x=function(a,b){a=this.offset+a*this.blockLength;b[0]=this.data[a]};SEA3D.AnimationData.prototype.getData2x=function(a,b){a=this.offset+a*this.blockLength;b[0]=this.data[a];b[1]=this.data[a+1]};SEA3D.AnimationData.prototype.getData3x=function(a,b){a=this.offset+a*this.blockLength;b[0]=this.data[a];b[1]=this.data[a+1];b[2]=this.data[a+2]};
SEA3D.AnimationData.prototype.getData4x=function(a,b){a=this.offset+a*this.blockLength;b[0]=this.data[a];b[1]=this.data[a+1];b[2]=this.data[a+2];b[3]=this.data[a+3]};
SEA3D.AnimationNode=function(a,b,c,d,e){this.name=a;this.frameRate=b;this.frameMill=1E3/b;this.numFrames=c;this.length=c-1;this.time=0;this.duration=this.length*this.frameMill;this.repeat=d;this.intrpl=e;this.invalidState=!0;this.dataList=[];this.dataListId={};this.buffer=new SEA3D.AnimationFrame;this.frame=this.nextFrame=this.prevFrame=this.percent=0};
SEA3D.AnimationNode.prototype.setTime=function(a){this.frame=this.validFrame(a/this.frameMill);this.time=this.frame*this.frameRate;this.invalidState=!0};SEA3D.AnimationNode.prototype.getTime=function(){return this.time};SEA3D.AnimationNode.prototype.setFrame=function(a){this.setTime(a*this.frameMill)};SEA3D.AnimationNode.prototype.getRealFrame=function(){return Math.floor(this.frame)};SEA3D.AnimationNode.prototype.getFrame=function(){return this.frame};
SEA3D.AnimationNode.prototype.setPosition=function(a){this.setFrame(a*(this.numFrames-1))};SEA3D.AnimationNode.prototype.getPosition=function(){return this.frame/(this.numFrames-1)};SEA3D.AnimationNode.prototype.validFrame=function(a){var b=0>a;b&&(a=-a);a>this.length&&(a=this.repeat?a%this.length:this.length);b&&(a=this.length-a);return a};SEA3D.AnimationNode.prototype.addData=function(a){this.dataListId[a.kind]=a;this.dataList[this.dataList.length]=a};
SEA3D.AnimationNode.prototype.removeData=function(a){delete this.dataListId[a.kind];this.dataList.splice(this.dataList.indexOf(a),1)};SEA3D.AnimationNode.prototype.getDataByKind=function(a){return this.dataListId[a]};SEA3D.AnimationNode.prototype.getFrameAt=function(a,b){this.dataListId[b].getFrameData(a,this.buffer.data);return this.buffer};SEA3D.AnimationNode.prototype.getFrame=function(a){this.dataListId[a].getFrameData(this.getRealFrame(),this.buffer.data);return this.buffer};
SEA3D.AnimationNode.prototype.getInterpolationFrame=function(a,b){if(0==this.numFrames)return this.buffer;this.invalidState&&(this.prevFrame=this.getRealFrame(),this.nextFrame=this.validFrame(this.prevFrame+1),this.percent=this.frame-this.prevFrame,this.invalidState=!1);a.getData(this.prevFrame,this.buffer.data);0<this.percent&&(a.getData(this.nextFrame,SEA3D.AnimationNode.FRAME_BUFFER),b(this.buffer.data,SEA3D.AnimationNode.FRAME_BUFFER,this.percent));return this.buffer};
SEA3D.AnimationNode.FRAME_BUFFER=[0,0,0,0];SEA3D.AnimationSet=function(){this.animations=[];this.dataCount=-1};SEA3D.AnimationSet.prototype.addAnimation=function(a){-1==this.dataCount&&(this.dataCount=a.dataList.length);this.animations[a.name]=a;this.animations.push(a)};SEA3D.AnimationSet.prototype.getAnimationByName=function(a){return this.animations[a]};SEA3D.AnimationState=function(a){this.node=a;this.time=this.weight=this.offset=0};
SEA3D.AnimationState.prototype.setTime=function(a){this.node.time=this.time=a};SEA3D.AnimationState.prototype.getTime=function(){return this.time};SEA3D.AnimationState.prototype.setFrame=function(a){this.node.setFrame(a);this.time=this.node.time};SEA3D.AnimationState.prototype.getFrame=function(){this.update();return this.node.getFrame()};SEA3D.AnimationState.prototype.setPosition=function(a){this.node.setPosition(a);this.time=this.node.time};
SEA3D.AnimationState.prototype.getPosition=function(){this.update();return this.node.getPosition()};SEA3D.AnimationState.prototype.update=function(){this.node.time!=this.time&&this.node.setTime(this.time)};
SEA3D.AnimationHandler=function(a){this.animationSet=a;this.states=SEA3D.AnimationHandler.stateFromAnimations(a.animations);this.timeScale=1;this.time=0;this.numAnimation=a.animations.length;this.playing=this.relative=!1;this.delta=0;this.easeSpeed=2;this.crossfade=0;this.updateAllStates=!1;this.blendMethod=SEA3D.AnimationBlendMethod.LINEAR};SEA3D.AnimationHandler.prototype.update=function(a){this.delta=a;this.time+=a*this.timeScale;this.updateState();this.updateAnimation()};
SEA3D.AnimationHandler.prototype.updateState=function(){var a,b;this.currentState.node.setTime(this.time-this.currentState.offset);if(1>this.currentState.weight&&0<this.crossfade){var c=Math.abs(this.delta)/(1E3*this.crossfade),d=1;this.blendMethod===SEA3D.AnimationBlendMethod.EASING&&(c*=this.easeSpeed);for(a=0;a<this.states.length;++a)b=this.states[a],b!==this.currentState&&(this.blendMethod===SEA3D.AnimationBlendMethod.LINEAR?b.weight-=c:this.blendMethod===SEA3D.AnimationBlendMethod.EASING&&(b.weight-=
b.weight*c),0>b.weight&&(b.weight=0),d-=b.weight,this.updateAllStates&&b.node.setTime(this.time-b.offset));0>d&&(d=0);this.currentState.weight=d}else for(a=0;a<this.states.length;++a)b=this.states[a],b===this.currentState?b.weight=1:(b.weight=0,this.updateAllStates&&b.node.setTime(this.time))};
SEA3D.AnimationHandler.prototype.updateAnimation=function(){for(var a=this.animationSet.dataCount,b=this.animationSet.animations,c=this.currentState.node,d=0;d<a;d++)for(var e=0;e<b.length;e++){var g=b[e],h=this.states[e],f=g.dataList[d],k=SEA3D.Animation.DefaultLerpFuncs[f.kind],l;if(0==e&&(l=c.getInterpolationFrame(c.dataList[d],k),!c.repeat&&c.frame==c.numFrames-1&&this.onComplete))this.onComplete(this);g!=c&&0<h.weight&&k(l.data,g.getInterpolationFrame(f,k).data,h.weight);this.updateAnimationFrame&&
this.updateAnimationFrame(l,f.kind)}};SEA3D.AnimationHandler.prototype.getStateByName=function(a){return this.states[a]};SEA3D.AnimationHandler.prototype.getStateNameByIndex=function(a){return this.animationSet.animations[a].name};
SEA3D.AnimationHandler.prototype.play=function(a,b,c){this.currentState=this.getStateByName(a);if(!this.currentState)throw Error('Animation "'+a+'" not found.');this.crossfade=b;this.currentState.offset=this.time;void 0!==c&&(this.currentState.time=c);this.playing||(SEA3D.AnimationHandler.add(this),this.playing=!0)};SEA3D.AnimationHandler.prototype.resume=function(){this.playing||(SEA3D.AnimationHandler.add(this),this.playing=!0)};
SEA3D.AnimationHandler.prototype.pause=function(){this.playing&&(SEA3D.AnimationHandler.remove(this),this.playing=!1)};SEA3D.AnimationHandler.prototype.stop=function(){this.time=0;this.pause()};SEA3D.AnimationHandler.prototype.setRelative=function(a){this.relative=a};SEA3D.AnimationHandler.prototype.getRelative=function(){return this.relative};SEA3D.AnimationHandler.add=function(a){SEA3D.AnimationHandler.animations.push(a)};
SEA3D.AnimationHandler.remove=function(a){SEA3D.AnimationHandler.animations.splice(SEA3D.AnimationHandler.animations.indexOf(a),1)};SEA3D.AnimationHandler.stateFromAnimations=function(a){for(var b=[],c=0;c<a.length;c++)b[a[c].name]=b[c]=new SEA3D.AnimationState(a[c]);return b};SEA3D.AnimationHandler.update=function(a){for(var b=0,c=SEA3D.AnimationHandler.animations.length;b<c;b++)SEA3D.AnimationHandler.animations[b].update(1E3*a)};
SEA3D.AnimationHandler.setTime=function(a){for(var b=0,c=SEA3D.AnimationHandler.animations.length;b<c;b++)SEA3D.AnimationHandler.animations[b].time=a};SEA3D.AnimationHandler.stop=function(){for(;SEA3D.AnimationHandler.animations.length;)SEA3D.AnimationHandler.animations[0].stop()};SEA3D.AnimationHandler.animations=[];SEA3D.Object=function(a,b,c,d){this.name=a;this.data=b;this.type=c;this.sea=d};
SEA3D.GeometryBase=function(a){var b=a.data;a.attrib=b.readUShort();a.isBigMesh=0!=(a.attrib&1);b.readVInt=a.isBigMesh?b.readUInt:b.readUShort;a.numVertex=b.readVInt();a.length=3*a.numVertex};
SEA3D.Geometry=function(a,b,c){var d,e;this.name=a;this.data=b;this.sea=c;SEA3D.GeometryBase(this);if(this.attrib&4)for(this.normal=[],a=0;a<this.length;)this.normal[a++]=b.readFloat();if(this.attrib&8)for(this.tangent=[],a=0;a<this.length;)this.tangent[a++]=b.readFloat();if(this.attrib&32)for(this.uv=[],this.uv.length=b.readUByte(),e=2*this.numVertex,a=0;a<this.uv.length;)for(this.uv[a++]=d=[],c=0;c<e;)d[c++]=b.readFloat();if(this.attrib&64){this.jointPerVertex=b.readUByte();c=this.numVertex*this.jointPerVertex;
this.joint=[];this.weight=[];for(a=0;a<c;)this.joint[a++]=b.readUShort();for(a=0;a<c;)this.weight[a++]=b.readFloat()}if(this.attrib&128)for(a=b.readUByte(),d=((a&64)>>6|(a&128)>>6)+1,e=4*this.numVertex,this.color=[],this.color.length=a&15,a=0;a<this.color.length;a++){var g=[];switch(d){case 1:for(c=0;c<e;)g[c++]=b.readUByte()/255,g[c++]=0,g[c++]=0,g[c++]=1;break;case 2:for(c=0;c<e;)g[c++]=b.readUByte()/255,g[c++]=b.readUByte()/255,g[c++]=0,g[c++]=1;break;case 3:for(c=0;c<e;)g[c++]=b.readUByte()/255,
g[c++]=b.readUByte()/255,g[c++]=b.readUByte()/255,g[c++]=1;break;case 4:for(c=0;c<e;)g[c++]=b.readUByte()/255,g[c++]=b.readUByte()/255,g[c++]=b.readUByte()/255,g[c++]=b.readUByte()/255}this.color[a]=g}this.vertex=[];for(a=0;a<this.length;)this.vertex[a++]=b.readFloat();this.indexes=[];this.indexes.length=b.readUByte();for(a=0;a<this.indexes.length;a++)for(e=3*b.readVInt(),this.indexes[a]=d=[],c=0;c<e;)d[c++]=b.readVInt()};SEA3D.Geometry.prototype.type="geo";
SEA3D.GeometryDelta=function(a,b,c){var d,e,g,h;this.name=a;this.data=b;this.sea=c;this.attrib=b.readUShort();this.numVertex=b.readUInteger();this.length=3*this.numVertex;this.attrib&1?(e=function(){return b.readByte()},g=127.5):(e=function(){return b.readShort()},g=32767.5);if(this.attrib&4)for(d=b.readFloat(),this.normal=[],a=0;a<this.length;)this.normal[a++]=e()/g*d;if(this.attrib&8)for(d=b.readFloat(),this.tangent=[],a=0;a<this.length;)this.tangent[a++]=e()/g*d;if(this.attrib&32){this.uv=[];this.uv.length=
b.readUByte();var f=2*this.numVertex;for(a=0;a<this.uv.length;)for(d=b.readFloat(),this.uv[a++]=h=[],c=0;c<f;)h[c++]=e()/g*d}if(this.attrib&64){this.jointPerVertex=b.readUByte();c=this.numVertex*this.jointPerVertex;this.joint=[];this.weight=[];for(a=0;a<c;)this.joint[a++]=b.readUInteger();for(a=0;a<c;)this.weight[a++]=e()/g*1}if(this.attrib&128)for(a=b.readUByte(),d=((a&64)>>6|(a&128)>>6)+1,h=4*this.numVertex,this.color=[],this.color.length=a&15,a=0;a<this.color.length;a++){f=[];switch(d){case 1:for(c=
0;c<h;)f[c++]=b.readUByte()/255,f[c++]=0,f[c++]=0,f[c++]=1;break;case 2:for(c=0;c<h;)f[c++]=b.readUByte()/255,f[c++]=b.readUByte()/255,f[c++]=0,f[c++]=1;break;case 3:for(c=0;c<h;)f[c++]=b.readUByte()/255,f[c++]=b.readUByte()/255,f[c++]=b.readUByte()/255,f[c++]=1;break;case 4:for(c=0;c<h;)f[c++]=b.readUByte()/255,f[c++]=b.readUByte()/255,f[c++]=b.readUByte()/255,f[c++]=b.readUByte()/255}this.color[a]=f}d=b.readFloat();this.vertex=[];for(a=0;a<this.length;)this.vertex[a++]=e()/g*d;this.indexes=[];this.indexes.length=
b.readUByte();if(this.attrib&2)for(a=0;a<this.indexes.length;a++)for(g=b.readUInteger(),this.indexes[a]=e=[],c=0;c<g;c++){d=b.readUInteger();h=b.readUInteger();var f=b.readUInteger(),k=b.readUInteger();e.push(d);e.push(h);e.push(f);0<k&&(e.push(f),e.push(k+1),e.push(d))}else for(g=3*b.readUInteger(),a=0;a<this.indexes.length;a++)for(this.indexes[a]=e=[],c=0;c<g;)e[c++]=b.readUInteger()};SEA3D.GeometryDelta.prototype.type="geDL";
SEA3D.Object3D={read:function(a){var b=a.data;a.isStatic=!1;a.attrib=b.readUShort();a.tags=[];a.attrib&1&&(a.parent=a.sea.getObject(b.readUInt()));a.attrib&2&&(a.animations=SEA3D.Animation.readAnimationList(b,a.sea));a.attrib&4&&(a.scripts=SEA3D.Script.readScriptList(b,a.sea));a.attrib&16&&(a.properties=a.sea.getObject(b.readUInt()));a.attrib&32&&(b=b.readUByte(),a.isStatic=b&1)},readTags:function(a,b){for(var c=a.data,d=c.readUByte(),e=0;e<d;++e){c.readUShort();var g=c.readUInt();c.position+=g}}};
SEA3D.Entity3D={read:function(a){SEA3D.Object3D.read(a);var b=a.data;a.castShadows=!0;a.attrib&64&&(b=b.readUByte(),a.castShadows=0==(b&1))},readTags:function(a,b){SEA3D.Object3D.readTags(a,b)}};SEA3D.Sound3D={read:function(a){SEA3D.Object3D.read(a);var b=a.data,c=a.sea;a.autoPlay=0!=(a.attrib&64);a.attrib&128&&(a.mixer=c.getObject(b.readUInt()));a.sound=c.getObject(b.readUInt());a.volume=b.readFloat()},readTags:function(a,b){SEA3D.Object3D.readTags(a,b)}};
SEA3D.SoundPoint=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.Sound3D.read(this);this.position=b.readVector3();this.distance=b.readFloat();SEA3D.Sound3D.readTags(this)};SEA3D.SoundPoint.prototype.type="sp";SEA3D.Container3D=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.Object3D.read(this);this.transform=b.readMatrix();SEA3D.Object3D.readTags(this)};SEA3D.Container3D.prototype.type="c3d";SEA3D.TextureURL=function(a,b,c){this.name=a;this.data=b;this.sea=c;this.url=b.readUTF(b.length)};
SEA3D.TextureURL.prototype.type="urlT";
SEA3D.Actions=function(a,b,c){this.name=a;this.data=b;this.sea=c;this.count=b.readUInt();this.action=[];for(a=0;a<this.count;a++){var d=b.readUByte(),e=b.readUShort(),g=b.readUShort(),h=b.position,f=this.action[a]={kind:e};d&1&&(f.range=[b.readUInt(),b.readUInt()]);d&2&&(f.time=b.readUInt());d&4&&(f.intrpl=SEA3D.DataTable.INTERPOLATION_TABLE[b.readUByte()],0==f.intrpl.indexOf("back.")?f.intrplParam0=b.readFloat():0==f.intrpl.indexOf("elastic.")&&(f.intrplParam0=b.readFloat(),f.intrplParam1=b.readFloat()));
switch(e){case SEA3D.Actions.RTT_TARGET:f.source=c.getObject(b.readUInt());f.target=c.getObject(b.readUInt());break;case SEA3D.Actions.LOOK_AT:f.source=c.getObject(b.readUInt());f.target=c.getObject(b.readUInt());break;case SEA3D.Actions.PLAY_SOUND:f.sound=c.getObject(b.readUInt());f.offset=b.readUInt();break;case SEA3D.Actions.PLAY_ANIMATION:f.object=c.getObject(b.readUInt());f.name=b.readUTF8();break;case SEA3D.Actions.FOG:f.color=b.readUInt24();f.min=b.readFloat();f.max=b.readFloat();break;case SEA3D.Actions.ENVIRONMENT:f.texture=
c.getObject(b.readUInt());break;case SEA3D.Actions.ENVIRONMENT_COLOR:f.color=b.readUInt24();break;case SEA3D.Actions.CAMERA:f.camera=c.getObject(b.readUInt());break;default:console.log('Action "'+e+'" not found.')}b.position=h+g}};SEA3D.Actions.SCENE=0;SEA3D.Actions.ENVIRONMENT_COLOR=1;SEA3D.Actions.ENVIRONMENT=2;SEA3D.Actions.FOG=3;SEA3D.Actions.PLAY_ANIMATION=4;SEA3D.Actions.PLAY_SOUND=5;SEA3D.Actions.ANIMATION_AUDIO_SYNC=6;SEA3D.Actions.LOOK_AT=7;SEA3D.Actions.RTT_TARGET=8;
SEA3D.Actions.CAMERA=9;SEA3D.Actions.prototype.type="act";
SEA3D.Script={DETAILED:!1,readScriptList:function(a,b){for(var c=[],d=a.readUByte(),e=0;e<d;){var g=a.readUByte(),h={};h.priority=g&1|g&2;if(g&4){var f,k,d=a.readUByte();if(SEA3D.Script.DETAILED)for(h.params=[],f=0;f<d;f++){k=a.readUTF8();var l=a.readUByte();h.params[f]={name:k,type:l,data:SEA3D.DataTable.readToken(l,a)}}else for(h.params={},f=0;f<d;f++)k=a.readUTF8(),h.params[k]=SEA3D.DataTable.readObject(a)}g&8&&(h.method=a.readUTF8());h.tag=b.getObject(a.readUInt());c[e++]=h}return c}};
SEA3D.JavaScript=function(a,b,c){this.name=a;this.data=b;this.sea=c};SEA3D.JavaScript.prototype.type="js";SEA3D.Dummy=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.Object3D.read(this);this.transform=b.readMatrix();this.width=b.readFloat();this.height=b.readFloat();this.depth=b.readFloat();SEA3D.Object3D.readTags(this)};SEA3D.Dummy.prototype.type="dmy";
SEA3D.Line=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.Object3D.read(this);this.count=3*(this.attrib&64?b.readUInt():b.readUShort());this.closed=0!=(this.attrib&128);this.transform=b.readMatrix();this.vertex=[];for(a=0;a<this.count;)this.vertex[a++]=b.readFloat();SEA3D.Object3D.readTags(this)};SEA3D.Line.prototype.type="line";SEA3D.PlanarRender=function(a,b,c){this.name=a;this.data=b;this.sea=c;this.attrib=b.readUByte();this.quality=this.attrib&1|this.attrib&2;this.transform=b.readMatrix()};
SEA3D.PlanarRender.prototype.type="rttp";SEA3D.CubeRender=function(a,b,c){this.name=a;this.data=b;this.sea=c;this.attrib=b.readUByte();this.quality=this.attrib&1|this.attrib&2;this.position=b.readVector3()};SEA3D.CubeRender.prototype.type="rttc";SEA3D.Mesh2D=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.Object3D.read(this);this.attrib&256&&(this.material=c.getObject(b.readUInt()));this.position=b.readVector3();this.width=b.readFloat();this.height=b.readFloat();SEA3D.Object3D.readTags(this)};
SEA3D.Mesh2D.prototype.type="m2d";
SEA3D.Mesh=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.Entity3D.read(this);if(this.attrib&256)if(this.material=[],a=b.readUByte(),1==a)this.material[0]=c.getObject(b.readUInt());else for(var d=0;d<a;){var e=b.readUInt();0<e?this.material[d++]=c.getObject(e-1):this.material[d++]=void 0}if(this.attrib&512)for(this.modifiers=[],a=b.readUByte(),d=0;d<a;d++)this.modifiers[d]=c.getObject(b.readUInt());this.transform=b.readMatrix();this.geometry=c.getObject(b.readUInt());SEA3D.Entity3D.readTags(this)};
SEA3D.Mesh.prototype.type="m3d";SEA3D.Skeleton=function(a,b,c){this.name=a;this.data=b;this.sea=c;a=b.readUShort();this.joint=[];for(c=0;c<a;c++)this.joint[c]={name:b.readUTF8(),parentIndex:b.readUShort()-1,inverseBindMatrix:b.readMatrix()}};SEA3D.Skeleton.prototype.type="skl";
SEA3D.SkeletonLocal=function(a,b,c){this.name=a;this.data=b;this.sea=c;a=b.readUShort();this.joint=[];for(c=0;c<a;c++)this.joint[c]={name:b.readUTF8(),parentIndex:b.readUShort()-1,x:b.readFloat(),y:b.readFloat(),z:b.readFloat(),qx:b.readFloat(),qy:b.readFloat(),qz:b.readFloat(),qw:b.readFloat(),sx:b.readFloat(),sy:b.readFloat(),sz:b.readFloat()}};SEA3D.SkeletonLocal.prototype.type="sklq";
SEA3D.AnimationBase={read:function(a){var b=a.data,c=b.readUByte();a.sequence=[];if(c&1)for(var d=b.readUShort(),e=0;e<d;e++)c=b.readUByte(),a.sequence[e]={name:b.readUTF8(),start:b.readUInt(),count:b.readUInt(),repeat:0!=(c&1),intrpl:0!=(c&2)};a.frameRate=b.readUByte();a.numFrames=b.readUInt();0==a.sequence.length&&(a.sequence[0]={name:"root",start:0,count:a.numFrames,repeat:!0,intrpl:!0})}};
SEA3D.Animation=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.AnimationBase.read(this);this.dataList=[];this.dataList.length=b.readUByte();for(a=0;a<this.dataList.length;a++){c=b.readUShort();var d=b.readUByte(),e=[];SEA3D.DataTable.readVector(d,b,e,this.numFrames,0);this.dataList[a]={kind:c,type:d,blockSize:SEA3D.DataTable.sizeOf(d),data:e}}};SEA3D.Animation.POSITION=0;SEA3D.Animation.ROTATION=1;SEA3D.Animation.SCALE=2;SEA3D.Animation.COLOR=3;SEA3D.Animation.MULTIPLIER=4;
SEA3D.Animation.ATTENUATION_START=5;SEA3D.Animation.ATTENUATION_END=6;SEA3D.Animation.FOV=7;SEA3D.Animation.OFFSET_U=8;SEA3D.Animation.OFFSET_V=9;SEA3D.Animation.SCALE_U=10;SEA3D.Animation.SCALE_V=11;SEA3D.Animation.ANGLE=12;SEA3D.Animation.ALPHA=13;SEA3D.Animation.VOLUME=14;
SEA3D.Animation.DefaultLerpFuncs=[SEA3D.Math.lerp3x,SEA3D.Math.lerpQuat4x,SEA3D.Math.lerp3x,SEA3D.Math.lerpColor1x,SEA3D.Math.lerp1x,SEA3D.Math.lerp1x,SEA3D.Math.lerp1x,SEA3D.Math.lerp1x,SEA3D.Math.lerp1x,SEA3D.Math.lerp1x,SEA3D.Math.lerp1x,SEA3D.Math.lerp1x,SEA3D.Math.lerpAng1x,SEA3D.Math.lerp1x,SEA3D.Math.lerp1x];
SEA3D.Animation.readAnimationList=function(a,b){for(var c=[],d=a.readUByte(),e=0;e<d;){var g=a.readUByte(),h={};h.relative=0!=(g&1);g&2&&(h.timeScale=a.readFloat());h.tag=b.getObject(a.readUInt());c[e++]=h}return c};SEA3D.Animation.prototype.type="anm";
SEA3D.SkeletonAnimation=function(a,b,c){this.name=a;this.data=b;this.sea=c;var d,e;SEA3D.AnimationBase.read(this);d=b.readUShort();this.pose=[];for(a=0;a<this.numFrames;a++){e=[];e.length=d;for(c=0;c<d;c++)e[c]={x:b.readFloat(),y:b.readFloat(),z:b.readFloat(),qx:b.readFloat(),qy:b.readFloat(),qz:b.readFloat(),qw:b.readFloat()};this.pose[a]=e}};SEA3D.SkeletonAnimation.prototype.type="skla";
SEA3D.Morph=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.GeometryBase(this);a=0!=(this.attrib&2);c=0!=(this.attrib&4);var d=3*this.numVertex,e=b.readUShort();this.node=[];var g,h;for(g=0;g<e;g++){var f=b.readUTF8();if(a){var k=[];for(h=0;h<d;)k[h++]=b.readFloat()}if(c){var l=[];for(h=0;h<d;)l[h++]=b.readFloat()}this.node[g]={vertex:k,normal:l,name:f}}};SEA3D.Morph.prototype.type="mph";
SEA3D.Camera=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.Object3D.read(this);this.attrib&64&&(this.dof={distance:b.readFloat(),range:b.readFloat()});this.transform=b.readMatrix();this.fov=b.readFloat();SEA3D.Object3D.readTags(this)};SEA3D.Camera.prototype.type="cam";SEA3D.JointObject=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.Object3D.read(this);this.target=c.getObject(b.readUInt());this.joint=b.readUShort();this.transform=b.readMatrix();this.fov=b.readFloat();SEA3D.Object3D.readTags(this)};
SEA3D.JointObject.prototype.type="jnt";SEA3D.Light={read:function(a){SEA3D.Object3D.read(a);var b=a.data;a.attenStart=Number.MAX_VALUE;a.attenEnd=Number.MAX_VALUE;if(a.attrib&64){var c=b.readUByte();a.shadow={};a.shadow.opacity=c&1?b.readFloat():1;a.shadow.color=c&2?b.readUInt24():0}a.attrib&512&&(a.attenStart=b.readFloat(),a.attenEnd=b.readFloat());a.color=b.readUInt24();a.multiplier=b.readFloat()}};
SEA3D.PointLight=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.Light.read(this);this.attrib&128&&(this.attenuation={start:b.readFloat(),end:b.readFloat()});this.position=b.readVector3();SEA3D.Object3D.readTags(this)};SEA3D.PointLight.prototype.type="plht";SEA3D.DirectionalLight=function(a,b,c){this.name=a;this.data=b;this.sea=c;SEA3D.Light.read(this);this.transform=b.readMatrix();SEA3D.Object3D.readTags(this)};SEA3D.DirectionalLight.prototype.type="dlht";
SEA3D.Material=function(a,b,c){this.name=a;this.data=b;this.sea=c;this.technique=[];this.attrib=b.readUShort();this.alpha=1;this.blendMode="normal";this.alphaThreshold=.5;this.bothSides=0!=(this.attrib&1);this.receiveLights=0==(this.attrib&2);this.receiveShadows=0==(this.attrib&4);this.receiveFog=0==(this.attrib&8);this.smooth=0==(this.attrib&16);this.attrib&32&&(this.alpha=b.readFloat());this.attrib&64&&(this.blendMode=b.readBlendMode());this.attrib&128&&(this.animations=SEA3D.Animation.readAnimationList(b,
c));this.depthMask=0==(this.attrib&256);a=b.readUByte();for(var d=0;d<a;++d){var e=b.readUShort(),g=b.readUShort(),h=b.position,f,k;switch(e){case SEA3D.Material.DEFAULT:f={ambientColor:b.readUInt24(),diffuseColor:b.readUInt24(),specularColor:b.readUInt24(),specular:b.readFloat(),gloss:b.readFloat()};break;case SEA3D.Material.COMPOSITE_TEXTURE:f={composite:c.getObject(b.readUInt())};break;case SEA3D.Material.DIFFUSE_MAP:f={texture:c.getObject(b.readUInt())};break;case SEA3D.Material.SPECULAR_MAP:f=
{texture:c.getObject(b.readUInt())};break;case SEA3D.Material.NORMAL_MAP:f={texture:c.getObject(b.readUInt())};break;case SEA3D.Material.REFLECTION:case SEA3D.Material.FRESNEL_REFLECTION:f={texture:c.getObject(b.readUInt()),alpha:b.readFloat()};e==SEA3D.Material.FRESNEL_REFLECTION&&(f.power=b.readFloat(),f.normal=b.readFloat());break;case SEA3D.Material.REFRACTION:f={texture:c.getObject(b.readUInt()),alpha:b.readFloat(),ior:b.readFloat()};break;case SEA3D.Material.RIM:f={color:b.readUInt24(),strength:b.readFloat(),
power:b.readFloat(),blendMode:b.readBlendMode()};break;case SEA3D.Material.LIGHT_MAP:f={texture:c.getObject(b.readUInt()),channel:b.readUByte(),blendMode:b.readBlendMode()};break;case SEA3D.Material.DETAIL_MAP:f={texture:c.getObject(b.readUInt()),scale:b.readFloat(),blendMode:b.readBlendMode()};break;case SEA3D.Material.CEL:f={color:b.readUInt24(),levels:b.readUByte(),size:b.readFloat(),specularCutOff:b.readFloat(),smoothness:b.readFloat()};break;case SEA3D.Material.TRANSLUCENT:f={color:b.readUInt24(),
translucency:b.readFloat(),scattering:b.readFloat()};break;case SEA3D.Material.BLEND_NORMAL_MAP:k=b.readUByte();f={texture:c.getObject(b.readUInt()),secondaryTexture:c.getObject(b.readUInt())};k&1?(f.offsetX0=b.readFloat(),f.offsetY0=b.readFloat(),f.offsetX1=b.readFloat(),f.offsetY1=b.readFloat()):f.offsetX0=f.offsetY0=f.offsetX1=f.offsetY1=0;f.animate=k&2;break;case SEA3D.Material.MIRROR_REFLECTION:f={texture:c.getObject(b.readUInt()),alpha:b.readFloat()};break;case SEA3D.Material.AMBIENT_MAP:f=
{texture:c.getObject(b.readUInt())};break;case SEA3D.Material.ALPHA_MAP:f={texture:c.getObject(b.readUInt())};break;case SEA3D.Material.EMISSIVE_MAP:f={texture:c.getObject(b.readUInt())};break;case SEA3D.Material.VERTEX_COLOR:f={blendMode:b.readBlendMode()};break;case SEA3D.Material.WRAP_LIGHTING:f={color:b.readUInt24(),strength:b.readFloat()};break;case SEA3D.Material.COLOR_REPLACE:f={color:b.readUInt24(),strength:b.readFloat()};break;case SEA3D.Material.COLOR_REPLACE:k=b.readUByte();f={red:b.readUInt24(),
green:b.readUInt24(),blue:b.readUInt24()};k&1&&(f.mask=c.getObject(b.readUInt()));k&2&&(f.alpha=b.readFloat());break;case SEA3D.Material.REFLECTION_SPHERICAL:f={texture:c.getObject(b.readUInt()),alpha:b.readFloat()};break;default:console.warn("SEA3D: MaterialTechnique not found:",e.toString(16));b.position=h+g;continue}f.kind=e;this.technique.push(f);b.position=h+g}};SEA3D.Material.DEFAULT=0;SEA3D.Material.COMPOSITE_TEXTURE=1;SEA3D.Material.DIFFUSE_MAP=2;SEA3D.Material.SPECULAR_MAP=3;
SEA3D.Material.REFLECTION=4;SEA3D.Material.REFRACTION=5;SEA3D.Material.NORMAL_MAP=6;SEA3D.Material.FRESNEL_REFLECTION=7;SEA3D.Material.RIM=8;SEA3D.Material.LIGHT_MAP=9;SEA3D.Material.DETAIL_MAP=10;SEA3D.Material.CEL=11;SEA3D.Material.TRANSLUCENT=12;SEA3D.Material.BLEND_NORMAL_MAP=13;SEA3D.Material.MIRROR_REFLECTION=14;SEA3D.Material.AMBIENT_MAP=15;SEA3D.Material.ALPHA_MAP=16;SEA3D.Material.EMISSIVE_MAP=17;SEA3D.Material.VERTEX_COLOR=18;SEA3D.Material.WRAP_LIGHTING=19;
SEA3D.Material.COLOR_REPLACE=20;SEA3D.Material.REFLECTION_SPHERICAL=21;SEA3D.Material.prototype.type="mat";SEA3D.Composite=function(a,b,c){this.name=a;this.data=b;this.sea=c;a=b.readUByte();this.layer=[];for(c=0;c<a;c++)this.layer[c]=this.readLayer(b,this)};SEA3D.Composite.prototype.getLayerByName=function(a){for(var b=0;b<this.layer.length;b++)if(this.layer[b].name==a)return this.layer[b]};
SEA3D.Composite.prototype.readLayer=function(a,b){this.scope=b;var c={blendMode:"normal",opacity:1},d=a.readUShort();d&1?c.texture=this.readLayerBitmap(a,b):c.color=a.readUInt24();d&2&&(c.mask=this.readLayerBitmap(a,b));d&4&&(c.name=a.readUTF8());d&8&&(c.blendMode=a.readBlendMode());d&16&&(c.opacity=a.readFloat());return c};
SEA3D.Composite.prototype.readLayerBitmap=function(a,b){this.scope=b;var c={channel:0,repeat:!0,offsetU:0,offsetV:0,scaleU:0,scaleV:0,rotation:0};c.map=b.sea.getObject(a.readUInt());var d=a.readUShort();0<d&&(d&1&&(c.channel=a.readUByte()),d&2&&(c.repeat=!1),d&4&&(c.offsetU=a.readFloat()),d&8&&(c.offsetV=a.readFloat()),d&16&&(c.scaleU=a.readFloat()),d&32&&(c.scaleV=a.readFloat()),d&64&&(c.rotation=a.readFloat()),d&128&&(c.animation=SEA3D.Animation.readAnimationList(a,b.sea)));return c};
SEA3D.Composite.prototype.type="ctex";SEA3D.CubeMap=function(a,b,c){this.name=a;this.data=b;this.sea=c;this.transparent=!1;b.readExt();this.faces=[];for(a=0;6>a;a++)c=b.readUInt(),this.faces[a]=b.concat(b.position,c),b.position+=c};SEA3D.CubeMap.prototype.type="cmap";SEA3D.JPEG=function(a,b,c){this.name=a;this.data=b;this.sea=c;this.transparent=!1};SEA3D.JPEG.prototype.type="jpg";SEA3D.JPEG_XR=function(a,b,c){this.name=a;this.data=b;this.sea=c;this.transparent=!0};SEA3D.JPEG_XR.prototype.type="wdp";
SEA3D.PNG=function(a,b,c){this.name=a;this.data=b;this.sea=c;this.transparent=6==b.buffer[25]};SEA3D.PNG.prototype.type="png";SEA3D.GIF=function(a,b,c){this.name=a;this.data=b;this.sea=c;this.transparent=0<b.buffer[11]};SEA3D.GIF.prototype.type="gif";SEA3D.MP3=function(a,b,c){this.name=a;this.data=b;this.sea=c};SEA3D.MP3.prototype.type="mp3";
SEA3D.File=function(a){this.stream=new SEA3D.Stream(a);this.version=SEA3D.VERSION;this.objects=[];this.typeClass={};this.typeRead={};this.position=this.dataPosition=0;this.scope=this;this.timeLimit=60;this.addClass(SEA3D.Geometry);this.addClass(SEA3D.GeometryDelta);this.addClass(SEA3D.Mesh);this.addClass(SEA3D.Mesh2D);this.addClass(SEA3D.Material);this.addClass(SEA3D.Composite);this.addClass(SEA3D.PointLight);this.addClass(SEA3D.DirectionalLight);this.addClass(SEA3D.Skeleton);this.addClass(SEA3D.SkeletonLocal);
this.addClass(SEA3D.SkeletonAnimation);this.addClass(SEA3D.JointObject);this.addClass(SEA3D.Camera);this.addClass(SEA3D.Morph);this.addClass(SEA3D.CubeMap);this.addClass(SEA3D.Animation);this.addClass(SEA3D.Dummy);this.addClass(SEA3D.Line);this.addClass(SEA3D.SoundPoint);this.addClass(SEA3D.PlanarRender);this.addClass(SEA3D.CubeRender);this.addClass(SEA3D.Actions);this.addClass(SEA3D.JavaScript);this.addClass(SEA3D.TextureURL);this.addClass(SEA3D.Container3D);this.addClass(SEA3D.JPEG);this.addClass(SEA3D.JPEG_XR);
this.addClass(SEA3D.PNG);this.addClass(SEA3D.GIF);this.addClass(SEA3D.MP3)};SEA3D.File.CompressionLibs={};SEA3D.File.DecompressionMethod={};SEA3D.File.setDecompressionEngine=function(a,b,c){SEA3D.File.CompressionLibs[a]=b;SEA3D.File.DecompressionMethod[a]=c};SEA3D.File.prototype.addClass=function(a){this.typeClass[a.prototype.type]=a};
SEA3D.File.prototype.readHead=function(){if(16>this.stream.bytesAvailable())return!1;"SEA"!=this.stream.readUTF(3)&&console.error("Invalid SEA3D format.");var a=this.stream.readUTF(3);"S3D"!=a&&console.warn('Signature "'+a+'" not recognized.');this.version=this.stream.readUInt24();if(0!=this.stream.readUByte())throw Error("Protection algorithm not is compatible.");this.compressionID=this.stream.readUByte();this.compressionAlgorithm=SEA3D.File.CompressionLibs[this.compressionID];this.decompressionMethod=
SEA3D.File.DecompressionMethod[this.compressionID];if(0<this.compressionID&&!this.decompressionMethod)throw Error("Compression algorithm not is compatible.");this.length=this.stream.readUInt();this.dataPosition=this.stream.position;this.objects.length=0;this.stage=this.readBody;return!0};SEA3D.File.prototype.getObject=function(a){return this.objects[a]};
SEA3D.File.prototype.readSEAObject=function(){if(4>this.stream.bytesAvailable())return null;var a=this.stream.readUInt(),b=this.stream.position;if(this.stream.bytesAvailable()<a)return null;var c=this.stream.readUByte(),d=this.stream.readExt(),e=c&1?this.stream.readUTF8():"",g=0!=(c&2),c=0!=(c&4),a=a-(this.stream.position-b),b=this.stream.position,h=this.stream.concat(b,a);c&&this.typeClass[d]?(g&&this.decompressionMethod&&h.set(this.decompressionMethod(h.buffer)),g=new this.typeClass[d](e,h,this),
this.typeRead[d]&&this.typeRead[d].call(this.scope,g)):(g=new SEA3D.Object(e,h,d,this),console.warn('SEA3D: Unknown format "'+d+'" of file "'+e+'". Add a module referring for this format.'));this.objects.push(this.objects[g.type+"/"+g.name]=g);this.dataPosition=b+a;++this.position;return g};
SEA3D.File.prototype.readBody=function(){for(this.timer.update();this.position<this.length;)if(this.timer.getDeltaTime()<this.timeLimit){this.stream.position=this.dataPosition;var a=this.readSEAObject();if(a)this.dispatchCompleteObject(a);else return!1}else return!1;this.stage=this.readComplete;return!0};SEA3D.File.prototype.readComplete=function(){this.stream.position=this.dataPosition;6202321!=this.stream.readUInt24()&&console.warn("SEA3D file is corrupted.");this.stage=null;this.dispatchComplete()};
SEA3D.File.prototype.readStage=function(a){for(;a.stage&&a.stage(););a.stage&&(window.setInterval(a.readStage,10,a),a.dispatchProgress())};SEA3D.File.prototype.read=function(){this.timer=new SEA3D.Timer;this.stage=this.readHead;this.readStage(this)};SEA3D.File.prototype.dispatchCompleteObject=function(a){if(this.onCompleteObject)this.onCompleteObject({file:this,object:a})};
SEA3D.File.prototype.dispatchProgress=function(){if(this.onProgress)this.onProgress({file:this,loaded:this.position,total:this.length,progress:this.position/this.length})};SEA3D.File.prototype.dispatchDownloadProgress=function(a,b){if(this.onDownloadProgress)this.onDownloadProgress({file:this,loaded:a,total:b,progress:a/b})};
SEA3D.File.prototype.dispatchComplete=function(){var a=this.timer.getElapsedTime(),b=a+"ms, "+this.objects.length+" objects";if(this.onComplete)this.onComplete({file:this,timeTotal:a,message:b});else console.log("SEA3D:",b)};SEA3D.File.prototype.dispatchError=function(a,b){if(this.onError)this.onError({file:this,id:a,message:b});else console.error("SEA3D: #"+a,b)};
SEA3D.File.prototype.load=function(a){var b=this,c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="arraybuffer";c.onprogress=function(a){a.lengthComputable&&b.dispatchDownloadProgress(a.loaded,a.total)};c.onreadystatechange=function(){2!==c.readyState&&3!==c.readyState&&4===c.readyState&&(200===c.status||0===c.status?(b.stream.set(new Uint8Array(this.response)),b.read()):this.dispatchError(1001,"Couldn't load ["+a+"] ["+c.status+"]"))};c.send()};var LZMA=LZMA||{};
LZMA.OutWindow=function(){this._windowSize=0};LZMA.OutWindow.prototype.create=function(a){this._buffer&&this._windowSize===a||(this._buffer=[]);this._windowSize=a;this._streamPos=this._pos=0};LZMA.OutWindow.prototype.flush=function(){var a=this._pos-this._streamPos;if(0!==a){for(;a--;)this._stream.writeByte(this._buffer[this._streamPos++]);this._pos>=this._windowSize&&(this._pos=0);this._streamPos=this._pos}};LZMA.OutWindow.prototype.releaseStream=function(){this.flush();this._stream=null};
LZMA.OutWindow.prototype.setStream=function(a){this.releaseStream();this._stream=a};LZMA.OutWindow.prototype.init=function(a){a||(this._pos=this._streamPos=0)};LZMA.OutWindow.prototype.copyBlock=function(a,b){var c=this._pos-a-1;for(0>c&&(c+=this._windowSize);b--;)c>=this._windowSize&&(c=0),this._buffer[this._pos++]=this._buffer[c++],this._pos>=this._windowSize&&this.flush()};LZMA.OutWindow.prototype.putByte=function(a){this._buffer[this._pos++]=a;this._pos>=this._windowSize&&this.flush()};
LZMA.OutWindow.prototype.getByte=function(a){a=this._pos-a-1;0>a&&(a+=this._windowSize);return this._buffer[a]};LZMA.RangeDecoder=function(){};LZMA.RangeDecoder.prototype.setStream=function(a){this._stream=a};LZMA.RangeDecoder.prototype.releaseStream=function(){this._stream=null};LZMA.RangeDecoder.prototype.init=function(){var a=5;this._code=0;for(this._range=-1;a--;)this._code=this._code<<8|this._stream.readByte()};
LZMA.RangeDecoder.prototype.decodeDirectBits=function(a){for(var b=0,c;a--;)this._range>>>=1,c=this._code-this._range>>>31,this._code-=this._range&c-1,b=b<<1|1-c,0===(this._range&4278190080)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8);return b};
LZMA.RangeDecoder.prototype.decodeBit=function(a,b){var c=a[b],d=(this._range>>>11)*c;if((this._code^2147483648)<(d^2147483648))return this._range=d,a[b]+=2048-c>>>5,0===(this._range&4278190080)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8),0;this._range-=d;this._code-=d;a[b]-=c>>>5;0===(this._range&4278190080)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8);return 1};LZMA.initBitModels=function(a,b){for(;b--;)a[b]=1024};
LZMA.BitTreeDecoder=function(a){this._models=[];this._numBitLevels=a};LZMA.BitTreeDecoder.prototype.init=function(){LZMA.initBitModels(this._models,1<<this._numBitLevels)};LZMA.BitTreeDecoder.prototype.decode=function(a){for(var b=1,c=this._numBitLevels;c--;)b=b<<1|a.decodeBit(this._models,b);return b-(1<<this._numBitLevels)};LZMA.BitTreeDecoder.prototype.reverseDecode=function(a){for(var b=1,c=0,d=0,e;d<this._numBitLevels;++d)e=a.decodeBit(this._models,b),b=b<<1|e,c|=e<<d;return c};
LZMA.reverseDecode2=function(a,b,c,d){for(var e=1,g=0,h=0,f;h<d;++h)f=c.decodeBit(a,b+e),e=e<<1|f,g|=f<<h;return g};LZMA.LenDecoder=function(){this._choice=[];this._lowCoder=[];this._midCoder=[];this._highCoder=new LZMA.BitTreeDecoder(8);this._numPosStates=0};LZMA.LenDecoder.prototype.create=function(a){for(;this._numPosStates<a;++this._numPosStates)this._lowCoder[this._numPosStates]=new LZMA.BitTreeDecoder(3),this._midCoder[this._numPosStates]=new LZMA.BitTreeDecoder(3)};
LZMA.LenDecoder.prototype.init=function(){var a=this._numPosStates;for(LZMA.initBitModels(this._choice,2);a--;)this._lowCoder[a].init(),this._midCoder[a].init();this._highCoder.init()};LZMA.LenDecoder.prototype.decode=function(a,b){return 0===a.decodeBit(this._choice,0)?this._lowCoder[b].decode(a):0===a.decodeBit(this._choice,1)?8+this._midCoder[b].decode(a):16+this._highCoder.decode(a)};LZMA.Decoder2=function(){this._decoders=[]};
LZMA.Decoder2.prototype.init=function(){LZMA.initBitModels(this._decoders,768)};LZMA.Decoder2.prototype.decodeNormal=function(a){var b=1;do b=b<<1|a.decodeBit(this._decoders,b);while(256>b);return b&255};LZMA.Decoder2.prototype.decodeWithMatchByte=function(a,b){var c=1,d,e;do if(d=b>>7&1,b<<=1,e=a.decodeBit(this._decoders,(1+d<<8)+c),c=c<<1|e,d!==e){for(;256>c;)c=c<<1|a.decodeBit(this._decoders,c);break}while(256>c);return c&255};LZMA.LiteralDecoder=function(){};
LZMA.LiteralDecoder.prototype.create=function(a,b){var c;if(!this._coders||this._numPrevBits!==b||this._numPosBits!==a)for(this._numPosBits=a,this._posMask=(1<<a)-1,this._numPrevBits=b,this._coders=[],c=1<<this._numPrevBits+this._numPosBits;c--;)this._coders[c]=new LZMA.Decoder2};LZMA.LiteralDecoder.prototype.init=function(){for(var a=1<<this._numPrevBits+this._numPosBits;a--;)this._coders[a].init()};
LZMA.LiteralDecoder.prototype.getDecoder=function(a,b){return this._coders[((a&this._posMask)<<this._numPrevBits)+((b&255)>>>8-this._numPrevBits)]};
LZMA.Decoder=function(){this._outWindow=new LZMA.OutWindow;this._rangeDecoder=new LZMA.RangeDecoder;this._isMatchDecoders=[];this._isRepDecoders=[];this._isRepG0Decoders=[];this._isRepG1Decoders=[];this._isRepG2Decoders=[];this._isRep0LongDecoders=[];this._posSlotDecoder=[];this._posDecoders=[];this._posAlignDecoder=new LZMA.BitTreeDecoder(4);this._lenDecoder=new LZMA.LenDecoder;this._repLenDecoder=new LZMA.LenDecoder;this._literalDecoder=new LZMA.LiteralDecoder;this._dictionarySizeCheck=this._dictionarySize=
-1;this._posSlotDecoder[0]=new LZMA.BitTreeDecoder(6);this._posSlotDecoder[1]=new LZMA.BitTreeDecoder(6);this._posSlotDecoder[2]=new LZMA.BitTreeDecoder(6);this._posSlotDecoder[3]=new LZMA.BitTreeDecoder(6)};LZMA.Decoder.prototype.setDictionarySize=function(a){if(0>a)return!1;this._dictionarySize!==a&&(this._dictionarySize=a,this._dictionarySizeCheck=Math.max(this._dictionarySize,1),this._outWindow.create(Math.max(this._dictionarySizeCheck,4096)));return!0};
LZMA.Decoder.prototype.setLcLpPb=function(a,b,c){var d=1<<c;if(8<a||4<b||4<c)return!1;this._literalDecoder.create(b,a);this._lenDecoder.create(d);this._repLenDecoder.create(d);this._posStateMask=d-1;return!0};
LZMA.Decoder.prototype.init=function(){var a=4;this._outWindow.init(!1);LZMA.initBitModels(this._isMatchDecoders,192);LZMA.initBitModels(this._isRep0LongDecoders,192);LZMA.initBitModels(this._isRepDecoders,12);LZMA.initBitModels(this._isRepG0Decoders,12);LZMA.initBitModels(this._isRepG1Decoders,12);LZMA.initBitModels(this._isRepG2Decoders,12);LZMA.initBitModels(this._posDecoders,114);for(this._literalDecoder.init();a--;)this._posSlotDecoder[a].init();this._lenDecoder.init();this._repLenDecoder.init();
this._posAlignDecoder.init();this._rangeDecoder.init()};
LZMA.Decoder.prototype.decode=function(a,b,c){var d=0,e=0,g=0,h=0,f=0,k=0,l=0;this._rangeDecoder.setStream(a);this._outWindow.setStream(b);for(this.init();0>c||k<c;)if(a=k&this._posStateMask,0===this._rangeDecoder.decodeBit(this._isMatchDecoders,(d<<4)+a))l=this._literalDecoder.getDecoder(k++,l),l=7<=d?l.decodeWithMatchByte(this._rangeDecoder,this._outWindow.getByte(e)):l.decodeNormal(this._rangeDecoder),this._outWindow.putByte(l),d=4>d?0:d-(10>d?3:6);else{if(1===this._rangeDecoder.decodeBit(this._isRepDecoders,
d))l=0,0===this._rangeDecoder.decodeBit(this._isRepG0Decoders,d)?0===this._rangeDecoder.decodeBit(this._isRep0LongDecoders,(d<<4)+a)&&(d=7>d?9:11,l=1):(0===this._rangeDecoder.decodeBit(this._isRepG1Decoders,d)?b=g:(0===this._rangeDecoder.decodeBit(this._isRepG2Decoders,d)?b=h:(b=f,f=h),h=g),g=e,e=b),0===l&&(l=2+this._repLenDecoder.decode(this._rangeDecoder,a),d=7>d?8:11);else if(f=h,h=g,g=e,l=2+this._lenDecoder.decode(this._rangeDecoder,a),d=7>d?7:10,a=this._posSlotDecoder[5>=l?l-2:3].decode(this._rangeDecoder),
4<=a)if(b=(a>>1)-1,e=(2|a&1)<<b,14>a)e+=LZMA.reverseDecode2(this._posDecoders,e-a-1,this._rangeDecoder,b);else{if(e+=this._rangeDecoder.decodeDirectBits(b-4)<<4,e+=this._posAlignDecoder.reverseDecode(this._rangeDecoder),0>e){if(-1===e)break;return!1}}else e=a;if(e>=k||e>=this._dictionarySizeCheck)return!1;this._outWindow.copyBlock(e,l);k+=l;l=this._outWindow.getByte(0)}this._outWindow.flush();this._outWindow.releaseStream();this._rangeDecoder.releaseStream();return!0};
LZMA.Decoder.prototype.setDecoderProperties=function(a){var b,c;if(5>a.size)return!1;b=a.readByte();c=b%9;b=~~(b/9);if(!this.setLcLpPb(c,b%5,~~(b/5)))return!1;b=a.readByte();b|=a.readByte()<<8;b|=a.readByte()<<16;b+=16777216*a.readByte();return this.setDictionarySize(b)};LZMA.decompress=function(a,b,c,d){var e=new LZMA.Decoder;if(!e.setDecoderProperties(a))throw"Incorrect stream properties";if(!e.decode(b,c,d))throw"Error in data stream";return!0};
LZMA.decompressFile=function(a,b){var c=new LZMA.Decoder,d;if(!c.setDecoderProperties(a))throw"Incorrect stream properties";d=a.readByte();d|=a.readByte()<<8;d|=a.readByte()<<16;d+=16777216*a.readByte();a.readByte();a.readByte();a.readByte();a.readByte();if(!c.decode(a,b,d))throw"Error in data stream";return!0};
SEA3D.File.LZMAUncompress=function(a){var b={data:[],position:0,writeByte:function(a){this.data[this.position++]=a}};LZMA.decompressFile({data:a,position:0,readByte:function(){return this.data[this.position++]}},b);return new Uint8Array(b.data)};SEA3D.File.setDecompressionEngine(2,"lzma",SEA3D.File.LZMAUncompress);
(function(a){var b,c,d=null,e,g,h,f,k,l,m,t,v,w,z,B,r,p,n=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],L=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],M=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],N=[16,17,18,0,8,7,9,6,10,
5,11,4,12,3,13,2,14,1,15],O=function(){this.list=this.next=null},P=function(){this.n=this.b=this.e=0;this.t=null},H=function(a,b,c,d,e,g){this.BMAX=16;this.N_MAX=288;this.status=0;this.root=null;this.m=0;var f=Array(this.BMAX+1),h,k,l,m,u,x,q,t=Array(this.BMAX+1),n,p,v,w=new P,z=Array(this.BMAX);m=Array(this.N_MAX);var y,r=Array(this.BMAX+1),A,B,D;D=this.root=null;for(u=0;u<f.length;u++)f[u]=0;for(u=0;u<t.length;u++)t[u]=0;for(u=0;u<z.length;u++)z[u]=null;for(u=0;u<m.length;u++)m[u]=0;for(u=0;u<r.length;u++)r[u]=
0;h=256<b?a[256]:this.BMAX;n=a;p=0;u=b;do f[n[p]]++,p++;while(0<--u);if(f[0]==b)this.root=null,this.status=this.m=0;else{for(x=1;x<=this.BMAX&&0==f[x];x++);q=x;g<x&&(g=x);for(u=this.BMAX;0!=u&&0==f[u];u--);l=u;g>u&&(g=u);for(A=1<<x;x<u;x++,A<<=1)if(0>(A-=f[x])){this.status=2;this.m=g;return}if(0>(A-=f[u]))this.status=2,this.m=g;else{f[u]+=A;r[1]=x=0;n=f;p=1;for(v=2;0<--u;)r[v++]=x+=n[p++];n=a;u=p=0;do 0!=(x=n[p++])&&(m[r[x]++]=u);while(++u<b);b=r[l];r[0]=u=0;n=m;p=0;m=-1;y=t[0]=0;v=null;for(B=0;q<=
l;q++)for(a=f[q];0<a--;){for(;q>y+t[1+m];){y+=t[1+m];m++;B=(B=l-y)>g?g:B;if((k=1<<(x=q-y))>a+1)for(k-=a+1,v=q;++x<B&&!((k<<=1)<=f[++v]);)k-=f[v];y+x>h&&y<h&&(x=h-y);B=1<<x;t[1+m]=x;v=Array(B);for(k=0;k<B;k++)v[k]=new P;D=null==D?this.root=new O:D.next=new O;D.next=null;D.list=v;z[m]=v;0<m&&(r[m]=u,w.b=t[m],w.e=16+x,w.t=v,x=(u&(1<<y)-1)>>y-t[m],z[m-1][x].e=w.e,z[m-1][x].b=w.b,z[m-1][x].n=w.n,z[m-1][x].t=w.t)}w.b=q-y;p>=b?w.e=99:n[p]<c?(w.e=256>n[p]?16:15,w.n=n[p++]):(w.e=e[n[p]-c],w.n=d[n[p++]-c]);
k=1<<q-y;for(x=u>>y;x<B;x+=k)v[x].e=w.e,v[x].b=w.b,v[x].n=w.n,v[x].t=w.t;for(x=1<<q-1;0!=(u&x);x>>=1)u^=x;for(u^=x;(u&(1<<y)-1)!=r[m];)y-=t[m],m--}this.m=t[1];this.status=0!=A&&1!=l?1:0}}},A=function(a){for(;f<a;){var b=h,c;c=r.length==p?-1:r[p++];h=b|c<<f;f+=8}},D=function(a){return h&n[a]},y=function(a){h>>=a;f-=a},I=function(a,d,e){var f,g,h;if(0==e)return 0;for(h=0;;){A(z);g=v.list[D(z)];for(f=g.e;16<f;){if(99==f)return-1;y(g.b);f-=16;A(f);g=g.t[D(f)];f=g.e}y(g.b);if(16==f)c&=32767,a[d+h++]=b[c++]=
g.n;else{if(15==f)break;A(f);m=g.n+D(f);y(f);A(B);g=w.list[D(B)];for(f=g.e;16<f;){if(99==f)return-1;y(g.b);f-=16;A(f);g=g.t[D(f)];f=g.e}y(g.b);A(f);t=c-g.n-D(f);for(y(f);0<m&&h<e;)m--,t&=32767,c&=32767,a[d+h++]=b[c++]=b[t++]}if(h==e)return e}k=-1;return h},Q=function(a,b,c){var d,e,f,g,h,k,l,m=Array(316);for(d=0;d<m.length;d++)m[d]=0;A(5);k=257+D(5);y(5);A(5);l=1+D(5);y(5);A(4);d=4+D(4);y(4);if(286<k||30<l)return-1;for(e=0;e<d;e++)A(3),m[N[e]]=D(3),y(3);for(;19>e;e++)m[N[e]]=0;z=7;e=new H(m,19,19,
null,null,z);if(0!=e.status)return-1;v=e.root;z=e.m;g=k+l;for(d=f=0;d<g;)if(A(z),h=v.list[D(z)],e=h.b,y(e),e=h.n,16>e)m[d++]=f=e;else if(16==e){A(2);e=3+D(2);y(2);if(d+e>g)return-1;for(;0<e--;)m[d++]=f}else{17==e?(A(3),e=3+D(3),y(3)):(A(7),e=11+D(7),y(7));if(d+e>g)return-1;for(;0<e--;)m[d++]=0;f=0}z=9;e=new H(m,k,257,q,E,z);0==z&&(e.status=1);if(0!=e.status)return-1;v=e.root;z=e.m;for(d=0;d<l;d++)m[d]=m[d+k];B=6;e=new H(m,l,0,L,M,B);w=e.root;B=e.m;return 0==B&&257<k||0!=e.status?-1:I(a,b,c)},R=function(a,
n,p){var r,G;for(r=0;r<p&&(!l||-1!=k);){if(0<m){if(0!=k)for(;0<m&&r<p;)m--,t&=32767,c&=32767,a[n+r++]=b[c++]=b[t++];else{for(;0<m&&r<p;)m--,c&=32767,A(8),a[n+r++]=b[c++]=D(8),y(8);0==m&&(k=-1)}if(r==p)break}if(-1==k){if(l)break;A(1);0!=D(1)&&(l=!0);y(1);A(2);k=D(2);y(2);v=null;m=0}switch(k){case 0:G=a;var J=n+r,K=p-r,F=void 0,F=f&7;y(F);A(16);F=D(16);y(16);A(16);if(F!=(~h&65535))G=-1;else{y(16);m=F;for(F=0;0<m&&F<K;)m--,c&=32767,A(8),G[J+F++]=b[c++]=D(8),y(8);0==m&&(k=-1);G=F}break;case 1:if(null!=
v)G=I(a,n+r,p-r);else a:{G=a;J=n+r;K=p-r;if(null==d){for(var C=void 0,F=Array(288),C=void 0,C=0;144>C;C++)F[C]=8;for(;256>C;C++)F[C]=9;for(;280>C;C++)F[C]=7;for(;288>C;C++)F[C]=8;g=7;C=new H(F,288,257,q,E,g);if(0!=C.status){alert("HufBuild error: "+C.status);G=-1;break a}d=C.root;g=C.m;for(C=0;30>C;C++)F[C]=5;zip_fixed_bd=5;C=new H(F,30,0,L,M,zip_fixed_bd);if(1<C.status){d=null;alert("HufBuild error: "+C.status);G=-1;break a}e=C.root;zip_fixed_bd=C.m}v=d;w=e;z=g;B=zip_fixed_bd;G=I(G,J,K)}break;case 2:G=
null!=v?I(a,n+r,p-r):Q(a,n+r,p-r);break;default:G=-1}if(-1==G)return l?0:-1;r+=G}return r};a.RawDeflate||(a.RawDeflate={});a.RawDeflate.inflate=function(a){var d,e=0;null==b&&(b=Array(65536));f=h=c=0;k=-1;l=!1;m=t=0;v=null;r=a;p=0;for(var g=new Uint8Array(1024),n=[];0<(a=R(g,0,g.length));)for(d=0;d<a;d++)n[e++]=g[d];r=null;return new Uint8Array(n)}})(this);SEA3D.File.DeflateUncompress=function(a){return RawDeflate.inflate(a)};SEA3D.File.setDecompressionEngine(1,"deflate",SEA3D.File.DeflateUncompress);
THREE.ShaderLib.replaceCode=function(a,b,c){for(var d=0;d<b.length;d++){var e=b[d],g=c[d],h=a.indexOf(e);-1<h&&(a=a.substring(0,h)+g+a.substring(h+e.length))}return a};
THREE.ShaderLib.phong.fragmentShader_StandardMaterial=THREE.ShaderLib.replaceCode(THREE.ShaderLib.phong.fragmentShader,["outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;","outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;"],["outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor + emissive ) * specular + totalSpecularLight;","outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor + emissive ) + totalSpecularLight;"]);
THREE.MeshPhongMaterial.prototype.emissiveToAmbientColor=!1;THREE.MeshPhongMaterial.prototype.CLONE=THREE.MeshPhongMaterial.prototype.clone;THREE.MeshPhongMaterial.prototype.clone=function(){var a=this.CLONE();a.emissiveToAmbientColor=this.emissiveToAmbientColor;return a};THREE.MeshPhongMaterial.prototype.__defineSetter__("__webglShader",function(a){this.emissiveToAmbientColor&&(a.fragmentShader=THREE.ShaderLib.phong.fragmentShader_StandardMaterial);this.__webglShader__=a});
THREE.MeshPhongMaterial.prototype.__defineGetter__("__webglShader",function(){return this.__webglShader__});THREE.Object3D.prototype.UPDATEMATRIXWORLD=THREE.Mesh.prototype.updateMatrixWorld;THREE.Object3D.prototype.updateMatrixWorld=function(a){this.animateMatrix?(this.UPDATEMATRIXWORLD(a),this.animateMatrix.compose(this.animatePosition,this.animateQuaternion,this.animateScale),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.animateMatrix)):this.UPDATEMATRIXWORLD(a)};
THREE.Object3D.prototype.setAnimateMatrix=function(a){this.getAnimateMatrix()!=a&&(a?(this.animateMatrix=new THREE.Matrix4,this.animatePosition=new THREE.Vector3,this.animateQuaternion=new THREE.Quaternion,this.animateScale=new THREE.Vector3(1,1,1)):(delete this.animateMatrix,delete this.animatePosition,delete this.animateQuaternion,delete this.animateScale),this.matrixWorldNeedsUpdate=!0)};THREE.Object3D.prototype.getAnimateMatrix=function(){return null!=this.animateMatrix};
THREE.Mesh.prototype.setWeight=function(a,b){this.morphTargetInfluences[this.geometry.morphTargets[a]]=b};THREE.Mesh.prototype.getWeight=function(a){return this.morphTargetInfluences[this.geometry.morphTargets[a]]};THREE.Mesh.prototype.DISPOSE=THREE.Mesh.prototype.dispose;THREE.Mesh.prototype.dispose=function(){this.animation&&this.animation.dispose();this.DISPOSE()};THREE.Mesh.prototype.CLONE=THREE.Mesh.prototype.clone;
THREE.Mesh.prototype.clone=function(a){a=THREE.Mesh.prototype.CLONE.call(this,a);a.animation&&(a.animation=this.animation.clone(a));return obj};THREE.SkinnedMesh.prototype.stop=function(){this.currentAnimation&&(this.currentAnimation.stop(),this.currentAnimation=null,this.isPlaying=!1)};THREE.SkinnedMesh.prototype.pause=function(){this.isPlaying&&(this.currentAnimation.pause(),this.isPlaying=!1)};
THREE.SkinnedMesh.prototype.resume=function(){!this.isPlaying&&this.currentAnimation&&(this.currentAnimation.pause(),this.isPlaying=!0)};THREE.SkinnedMesh.prototype.isPlaying=!1;
THREE.SkinnedMesh.prototype.play=function(a,b,c){this.previousAnimation=this.currentAnimation;this.currentAnimation=this.animations[a];if(!this.currentAnimation)throw Error('Animation "'+a+'" not found.');this.previousAnimation&&this.previousAnimation!==this.currentAnimation&&0<b?(this.previousAnimation.play(this.previousAnimation.currentTime,this.previousAnimation.weight),this.currentAnimation.play(void 0!==c?c:this.currentAnimation.currentTime,this.currentAnimation.weight),THREE.AnimationHandler.addCrossfade(this,
b)):this.currentAnimation.play(void 0!==c?c:this.currentAnimation.currentTime,1);this.isPlaying=!0};THREE.SkinnedMesh.prototype.setAnimations=function(a){this.animations=[];this.weightSchedule=[];this.warpSchedule=[];var b=a[0].name.indexOf("/")+1;this.animationNamespace=a[0].name.substring(0,b);for(var c=0;c<a.length;c++){var d=a[c].name.substring(b);this.animations[c]=new THREE.Animation(this,a[c]);this.animations[c].loop=a[c].repeat;this.animations[c].name=d;this.animations[d]=this.animations[c]}};
THREE.SkinnedMesh.prototype.DISPOSE=THREE.SkinnedMesh.prototype.dispose;THREE.SkinnedMesh.prototype.dispose=function(){this.stop();this.animations=null;this.DISPOSE()};THREE.SkinnedMesh.prototype.CLONE=THREE.SkinnedMesh.prototype.clone;
THREE.SkinnedMesh.prototype.clone=function(a){a=THREE.SkinnedMesh.prototype.CLONE.call(this,a);a.animation&&(a.animation=this.animation.clone(a));a.animations=[];for(var b=this.geometry.animations,c=b[0].name.indexOf("/")+1,d=0;d<b.length;d++){var e=b[d].name.substring(c),g=b[d];g.initialized=!1;a.animations[d]=new THREE.Animation(a,g);a.animations[d].loop=b[d].repeat;a.animations[d].name=e}return a};THREE.AnimationHandler.crossfade=[];THREE.AnimationHandler.UPDATE=THREE.AnimationHandler.update;
THREE.AnimationHandler.update=function(a){var b,c=THREE.AnimationHandler.crossfade;for(b=0;b<c.length;){var d=c[b];d.currentAnimation.weight+=a/d.crossfade;if(1<d.currentAnimation.weight){d.previousAnimation.weight=0;d.currentAnimation.weight=1;if(d.onCrossfadeComplete)d.onCrossfadeComplete(d);c.splice(b,1);delete d.crossfade}else++b;d.previousAnimation.weight=1-d.currentAnimation.weight}THREE.AnimationHandler.UPDATE(a)};
THREE.AnimationHandler.addCrossfade=function(a,b){void 0!==a.crossfade&&THREE.AnimationHandler.crossfade.splice(THREE.AnimationHandler.crossfade.indexOf(a),1);a.crossfade=b;THREE.AnimationHandler.crossfade.push(a)};THREE.Animation.prototype.STOP=THREE.Animation.prototype.stop;THREE.Animation.prototype.stop=function(){if(this.onComplete)this.onComplete(this);this.STOP()};THREE.Animation.prototype.RESET=THREE.Animation.prototype.reset;
THREE.Animation.prototype.reset=function(){if(this.onReset)this.onReset(this);this.RESET()};THREE.Sound3D=function(a,b,c){THREE.Object3D.call(this);this.audio=new Audio;this.audio.src=a;this.audio.load();this.distance=void 0!==c?c:1E3;this.volume=void 0!==b?b:1;this.playing=!1};THREE.Sound3D.prototype=Object.create(THREE.Object3D.prototype);THREE.Sound3D.prototype.loop=!1;
THREE.Sound3D.prototype.play=function(a){void 0!==a&&0<this.audio.duration&&(this.audio.currentTime=a);this.audio.loop=this.loop;this.audio.play();this.playing||(this.index=THREE.Sound3D.sounds.length,THREE.Sound3D.sounds.push(this),this.playing=!0)};THREE.Sound3D.prototype.stop=function(){0<this.audio.duration&&(this.audio.currentTime=0);this.pause()};THREE.Sound3D.prototype.pause=function(){this.audio.pause();this.playing&&(THREE.Sound3D.sounds.splice(this.index,1),this.playing=!1)};
THREE.Sound3D.prototype.update=function(a){var b=new THREE.Vector3;b.setFromMatrixPosition(this.matrixWorld);var c=new THREE.Vector3;c.setFromMatrixPosition(a.matrixWorld);a=b.distanceTo(c);this.audio.volume=Math.max(0,Math.min(1,this.volume*(1-a/(3*this.distance))))};THREE.Sound3D.sounds=[];THREE.Sound3D.update=function(a){for(var b=THREE.Sound3D.sounds,c=0;c<b.length;c++)b[c].update(a)};THREE.Bone.fromName=function(a,b){for(var c=a.bones,d=0,e=c.length;d<e;d++)if(b==c[d].name)return c[d]};
THREE.SEA3D=function(a){this.config=a||{};void 0===this.config.autoPlay&&(this.config.autoPlay=!1);void 0===this.config.flip&&(this.config.flip=!0);void 0==this.config.parser&&(this.config.parser=THREE.SEA3D.AUTO);void 0==this.config.multiplier&&(this.config.multiplier=1);void 0==this.config.tangent&&(this.config.tangent=!0);void 0==this.config.bounding&&(this.config.bounding=!0);this.container=this.config.container||new THREE.Object3D;this.objects={}};
THREE.SEA3D.prototype={constructor:THREE.SEA3D,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent};THREE.SEA3D.BUFFER0=new THREE.Matrix4;THREE.SEA3D.BUFFER1=new THREE.Matrix4;THREE.SEA3D.BUFFER2=new THREE.Matrix4;THREE.SEA3D.BUFFER3=new THREE.Matrix4;THREE.SEA3D.QUABUF0=new THREE.Quaternion;
THREE.SEA3D.QUABUF1=new THREE.Quaternion;THREE.SEA3D.VECBUF0=new THREE.Vector3;THREE.SEA3D.VECBUF1=new THREE.Vector3;THREE.SEA3D.CONTAINER=new THREE.Object3D;THREE.SEA3D.VECZERO=new THREE.Vector3;THREE.SEA3D.AUTO="auto";THREE.SEA3D.DEFAULT="default";THREE.SEA3D.BUFFER="buffer";THREE.SEA3D.BACKGROUND_COLOR=3355443;THREE.SEA3D.HELPER_COLOR=10140133;THREE.SEA3D.TEXTURE_SIZE=512;
THREE.SEA3D.prototype.setShadowMap=function(a,b){a.shadowMapWidth=a.shadowMapHeight=2048;a.castShadow=!0;a.shadowDarkness=void 0!==b?b:1};THREE.SEA3D.prototype.getMesh=function(a){return this.objects["m3d/"+a]};THREE.SEA3D.prototype.getDummy=function(a){return this.objects["dmy/"+a]};THREE.SEA3D.prototype.getLine=function(a){return this.objects["line/"+a]};THREE.SEA3D.prototype.getSound3D=function(a){return this.objects["sn3d/"+a]};
THREE.SEA3D.prototype.getMaterial=function(a){return this.objects["mat/"+a]};THREE.SEA3D.prototype.getLight=function(a){return this.objects["lht/"+a]};THREE.SEA3D.prototype.getCamera=function(a){return this.objects["cam/"+a]};THREE.SEA3D.prototype.getTexture=function(a){return this.objects["tex/"+a]};THREE.SEA3D.prototype.getCubeMap=function(a){return this.objects["cmap/"+a]};THREE.SEA3D.prototype.getJointObject=function(a){return this.objects["jnt/"+a]};
THREE.SEA3D.prototype.getContainer3D=function(a){return this.objects["c3d/"+a]};THREE.SEA3D.prototype.getSprite=function(a){return this.objects["m2d/"+a]};THREE.SEA3D.prototype.isPowerOfTwo=function(a){return a?(a&-a)==a:!1};THREE.SEA3D.prototype.nearestPowerOfTwo=function(a){return Math.pow(2,Math.round(Math.log(a)/Math.LN2))};THREE.SEA3D.prototype.vectorToVector3=function(a){for(var b=[],c=0,d=0;c<a.length;)b[d++]=new THREE.Vector3(a[c++],a[c++],a[c++]);return b};
THREE.SEA3D.prototype.vectorToVector3Inv=function(a){for(var b=[],c=0,d=0;c<a.length;)b[d++]=new THREE.Vector3(a[c++],a[c++],-a[c++]);return b};THREE.SEA3D.prototype.flipMatrixScale=function(a){a.decompose(THREE.SEA3D.VECBUF0,THREE.SEA3D.QUABUF0,THREE.SEA3D.VECBUF1);THREE.SEA3D.VECBUF1.z=-THREE.SEA3D.VECBUF1.z;a.compose(THREE.SEA3D.VECBUF0,THREE.SEA3D.QUABUF0,THREE.SEA3D.VECBUF1);return a};
THREE.SEA3D.prototype.flipMatrixGlobal=function(a){a.decompose(THREE.SEA3D.VECBUF0,THREE.SEA3D.QUABUF0,THREE.SEA3D.VECBUF1);THREE.SEA3D.VECBUF1.z=-THREE.SEA3D.VECBUF1.z;THREE.SEA3D.VECBUF1.y=-THREE.SEA3D.VECBUF1.y;THREE.SEA3D.VECBUF1.x=-THREE.SEA3D.VECBUF1.x;a.compose(THREE.SEA3D.VECBUF0,THREE.SEA3D.QUABUF0,THREE.SEA3D.VECBUF1);return a};
THREE.SEA3D.prototype.flipMatrix=function(a){var b=THREE.SEA3D.BUFFER0.copy(a);a.setPosition(THREE.SEA3D.VECZERO);a.multiplyMatrices(THREE.SEA3D.BUFFER1.makeRotationAxis(THREE.SEA3D.VECBUF0.set(0,0,1),THREE.Math.degToRad(180)),a);a.makeRotationFromQuaternion(THREE.SEA3D.QUABUF0.setFromRotationMatrix(a));b=THREE.SEA3D.VECBUF0.setFromMatrixPosition(b);b.z=-b.z;a.setPosition(b);return a};
THREE.SEA3D.prototype.applyMatrix=function(a,b){var c=THREE.SEA3D.VECBUF0;a.position.setFromMatrixPosition(b);a.scale.setFromMatrixScale(b);b.scale(c.set(1/a.scale.x,1/a.scale.y,1/a.scale.z));a.rotation.setFromRotationMatrix(b)};
THREE.SEA3D.prototype.updateMatrix=function(a){var b=THREE.SEA3D.BUFFER2,c=THREE.SEA3D.BUFFER3;a.updateMatrixWorld();b.copy(a.matrixWorld);this.flipMatrixScale(b);c.copy(a.parent.matrixWorld);a.parent instanceof THREE.Bone?this.flipMatrixGlobal(c):this.flipMatrixScale(c);c.getInverse(c);b.multiplyMatrices(c,b);this.applyMatrix(a,b)};
THREE.SEA3D.prototype.updateTransform=function(a,b){var c=THREE.SEA3D.BUFFER2;b.transform?c.elements=b.transform:c.makeTranslation(b.position.x,b.position.y,b.position.z);this.applyMatrix(a,c);this.updateMatrix(a);b.isStatic&&(a.updateMatrixWorld(),a.matrixAutoUpdate=!1)};
THREE.SEA3D.prototype.updateAnimationSet=function(a){var b=a.animation.animationSet;if(!b.flip){for(var c=b.animations,d=0;d<c.length;d++){var e=c[d].dataList,g=[],h;for(h=0;h<e.length;h++){var f=e[d],k=e[d].data,l=f.kind,f=k.length/f.blockLength;switch(l){case SEA3D.Animation.POSITION:case SEA3D.Animation.ROTATION:g.push({kind:l,numFrames:f,raw:k})}}if(0<g.length){f=g[0].numFrames;e=THREE.SEA3D.CONTAINER;e.position.set(0,0,0);e.rotation.set(0,0,0);e.scale.set(1,1,1);a.add(e);h=0;for(var m;h<f;h++){for(m=
0;m<g.length;m++)switch(k=g[m].raw,l=g[m].kind,l){case SEA3D.Animation.POSITION:l=3*h;e.position.set(k[l],k[l+1],k[l+2]);break;case SEA3D.Animation.ROTATION:l=4*h,e.quaternion.set(k[l],k[l+1],k[l+2],k[l+3])}this.updateMatrix(e);for(m=0;m<g.length;m++)switch(k=g[m].raw,l=g[m].kind,l){case SEA3D.Animation.POSITION:l=3*h;k[l]=e.position.x;k[l+1]=e.position.y;k[l+2]=e.position.z;break;case SEA3D.Animation.ROTATION:l=4*h,k[l]=e.quaternion.x,k[l+1]=e.quaternion.y,k[l+2]=e.quaternion.z,k[l+3]=e.quaternion.w}}a.remove(e)}}b.flip=
!0}};THREE.SEA3D.prototype.vectorToColor=function(a){for(var b=[],c=0,d=0,e,g,h,f;c<a.length;)e=255*a[c++],g=255*a[c++],h=255*a[c++],f=255*a[c++],b[d++]=new THREE.Color(f<<24|e<<16|g<<8|h);return b};THREE.SEA3D.prototype.vectorToUV=function(a){for(var b=[],c=0;c<a.length;c++)for(var d=b[c]=[],e=a[c],g=0,h=0;g<e.length;g+=2)d[h++]=new THREE.Vector2(e[g],e[g+1]);return b};THREE.SEA3D.prototype.toVector3=function(a){return new THREE.Vector3(a.x,a.y,a.z)};
THREE.SEA3D.prototype.scaleColor=function(a,b){return(a>>16)*b<<16|(a>>8&255)*b<<8|(a&255)*b};THREE.SEA3D.prototype.updateScene=function(){if(void 0!=this.materials)for(var a=0,b=this.materials.length;a<b;++a)this.materials[a].needsUpdate=!0};THREE.SEA3D.prototype.addSceneObject=function(a){a.parent?a.parent.tag.add(a.tag):this.config.container?this.config.container.add(a.tag):this.container.add(a.tag)};THREE.SEA3D.prototype.bufferToTexture=function(a){return"data:image/png;base64,"+SEA3D.Stream.bufferToBase64(a)};
THREE.SEA3D.prototype.bufferToSound=function(a){return"data:audio/mp3;base64,"+SEA3D.Stream.bufferToBase64(a)};
THREE.SEA3D.prototype.applyDefaultAnimation=function(a,b){for(var c=a.tag,d=0,e=a.animations?a.animations.length:0;d<e;d++){var g=a.animations[d];switch(g.tag.type){case SEA3D.Animation.prototype.type:return c.animation=new b(c,g.tag.tag),c.animation.setRelative(g.relative),this.config.flip&&this.updateAnimationSet(c),this.config.autoPlay&&c.animation.play(c.animation.getStateNameByIndex(0)),c.animation}}};
THREE.SEA3D.prototype.readAnimation=function(a){for(var b=new SEA3D.AnimationSet,c=0;c<a.sequence.length;c++){for(var d=a.sequence[c],e=new SEA3D.AnimationNode(d.name,a.frameRate,d.count,d.repeat,d.intrpl),g=0;g<a.dataList.length;g++){var h=a.dataList[g];e.addData(new SEA3D.AnimationData(h.kind,h.type,h.data,d.start*h.blockSize))}b.addAnimation(e)}this.animationSets=this.animationSets||[];this.animationSets.push(this.objects[a.name+".#anm"]=a.tag=b)};
THREE.SEA3D.Object3DAnimator=function(a,b){SEA3D.AnimationHandler.call(this,b);this.object3d=a};THREE.SEA3D.Object3DAnimator.prototype=Object.create(SEA3D.AnimationHandler.prototype);THREE.SEA3D.Object3DAnimator.prototype.STOP=THREE.SEA3D.Object3DAnimator.prototype.stop;THREE.SEA3D.Object3DAnimator.prototype.stop=function(){this.relative&&(this.object3d.animatePosition=new THREE.Vector3,this.object3d.animateQuaternion=new THREE.Quaternion,this.object3d.animateScale=new THREE.Vector3(1,1,1));this.STOP()};
THREE.SEA3D.Object3DAnimator.prototype.setRelative=function(a){this.object3d.setAnimateMatrix(this.relative=a)};
THREE.SEA3D.Object3DAnimator.prototype.updateAnimationFrame=function(a,b){if(this.relative){switch(b){case SEA3D.Animation.POSITION:var c=a.toVector();this.object3d.animatePosition.set(c.x,c.y,c.z);break;case SEA3D.Animation.ROTATION:c=a.toVector();this.object3d.animateQuaternion.set(c.x,c.y,c.z,c.w);break;case SEA3D.Animation.SCALE:c=a.toVector(),this.object3d.animateScale.set(c.x,c.y,c.z)}this.object3d.matrixWorldNeedsUpdate=!0}else switch(b){case SEA3D.Animation.POSITION:c=a.toVector();this.object3d.position.set(c.x,
c.y,c.z);break;case SEA3D.Animation.ROTATION:c=a.toVector();this.object3d.quaternion.set(c.x,c.y,c.z,c.w);break;case SEA3D.Animation.SCALE:c=a.toVector(),this.object3d.scale.set(c.x,c.y,c.z)}};THREE.SEA3D.CameraAnimator=function(a,b){THREE.SEA3D.Object3DAnimator.call(this,a,b)};THREE.SEA3D.CameraAnimator.prototype=Object.create(THREE.SEA3D.Object3DAnimator.prototype);
THREE.SEA3D.CameraAnimator.prototype.updateAnimationFrame=function(a,b){switch(b){case SEA3D.Animation.FOV:this.object3d.fov=a.getX();break;default:this.$updateAnimationFrame(a,b)}};THREE.SEA3D.CameraAnimator.prototype.$updateAnimationFrame=THREE.SEA3D.Object3DAnimator.prototype.updateAnimationFrame;THREE.SEA3D.LightAnimator=function(a,b){THREE.SEA3D.Object3DAnimator.call(this,a,b)};THREE.SEA3D.LightAnimator.prototype=Object.create(THREE.SEA3D.Object3DAnimator.prototype);
THREE.SEA3D.LightAnimator.prototype.updateAnimationFrame=function(a,b){switch(b){case SEA3D.Animation.COLOR:this.object3d.color.setHex(a.getX());break;case SEA3D.Animation.MULTIPLIER:this.object3d.intensity=a.getX();break;default:this.$updateAnimationFrame(a,b)}};THREE.SEA3D.LightAnimator.prototype.$updateAnimationFrame=THREE.SEA3D.Object3DAnimator.prototype.updateAnimationFrame;
THREE.SEA3D.prototype.readGeometrySwitch=function(a){!(65534>a.numVertex)||a.joint||a.uv&&1!==a.uv.length||1!==a.indexes.length?this.readGeometry(a):this.readGeometryBuffer(a)};
THREE.SEA3D.prototype.readGeometryBuffer=function(a){var b=a.indexes[0],c=b.length,d=new THREE.BufferGeometry,e,g,h,f,k;d.attributes={index:{itemSize:1,array:e=new Uint16Array(c)},position:{itemSize:3,array:g=new Float32Array(3*c)},uv:{itemSize:2,array:f=new Float32Array(2*c)}};var l,m,t,v=a.vertex,w=a.normal,z=a.tangent,B=a.uv?a.uv[0]:void 0,r=a.color?a.color[0]:void 0;w&&(d.attributes.normal={itemSize:3,array:h=new Float32Array(3*c)});z&&(d.attributes.tangent={itemSize:3,array:h=new Float32Array(3*
c)});r&&(d.attributes.color={itemSize:3,array:k=new Float32Array(3*c)});for(var p=this.config.flip?-1:1,n=0,q=0,E=0;n<c;n+=3,q+=9,E+=6)l=3*b[n],m=3*b[n+2],t=3*b[n+1],g[q]=v[l],g[q+1]=v[l+1],g[q+2]=v[l+2]*p,g[q+3]=v[m],g[q+4]=v[m+1],g[q+5]=v[m+2]*p,g[q+6]=v[t],g[q+7]=v[t+1],g[q+8]=v[t+2]*p,w&&(h[q]=w[l],h[q+1]=w[l+1],h[q+2]=w[l+2]*p,h[q+3]=w[m],h[q+4]=w[m+1],h[q+5]=w[m+2]*p,h[q+6]=w[t],h[q+7]=w[t+1],h[q+8]=w[t+2]*p),z&&(tangent[q]=z[l],tangent[q+1]=z[l+1],tangent[q+2]=z[l+2]*p,tangent[q+3]=z[m],tangent[q+
4]=z[m+1],tangent[q+5]=z[m+2]*p,tangent[q+6]=z[t],tangent[q+7]=z[t+1],tangent[q+8]=z[t+2]*p),B?(l=2*b[n],m=2*b[n+2],t=2*b[n+1],f[E]=B[l],f[E+1]=B[l+1],f[E+2]=B[m],f[E+3]=B[m+1],f[E+4]=B[t],f[E+5]=B[t+1]):(f[E]=0,f[E+1]=0,f[E+2]=0,f[E+3]=1,f[E+4]=1,f[E+5]=1),r&&(l=4*b[n],m=4*b[n+2],t=4*b[n+1],k[q]=r[l],k[q+1]=r[l+1],k[q+2]=r[l+2],k[q+3]=r[m],k[q+4]=r[m+1],k[q+5]=r[m+2],k[q+6]=r[t],k[q+7]=r[t+1],k[q+8]=r[t+2]),e[n]=n,e[n+1]=n+1,e[n+2]=n+2;65534<=a.numVertex&&console.warn("SEA3D: Big Mesh is not compatible with geometry buffer.");
w||d.computeVertexNormals();this.config.tangent&&!a.tangent&&d.computeTangents();this.config.bounding&&(d.computeBoundingBox(),d.computeBoundingSphere());d.name=a.name;a.tag=d};
THREE.SEA3D.prototype.readGeometry=function(a){var b,c,d,e=new THREE.Geometry,g,h,f,k;e.vertices=this.config.flip?this.vectorToVector3Inv(a.vertex):this.vectorToVector3(a.vertex);a.normal&&(g=this.config.flip?this.vectorToVector3Inv(a.normal):this.vectorToVector3(a.normal));a.tangent&&(h=this.config.flip?this.vectorToVector3Inv(a.tangent):this.vectorToVector3(a.tangent));a.color&&(f=this.vectorToColor(a.color[0]));if(a.uv)for(k=this.vectorToUV(a.uv),d=0;d<k.length;d++)e.faceVertexUvs[d]=[];for(b=
0;b<a.indexes.length;b++){var l=a.indexes[b],m=l.length/3;for(c=0;c<m;c++){d=3*c;var t,v,w;t=l[d];w=l[d+1];v=l[d+2];d=new THREE.Face3(t,v,w,g?[g[t],g[v],g[w]]:void 0,f?[f[t],f[v],f[w]]:void 0,b);h&&(d.vertexTangents=[h[t],h[v],h[w]]);e.faces.push(d);if(k)for(d=0;d<k.length;d++)e.faceVertexUvs[d].push([k[d][t],k[d][v],k[d][w]]);else e.faceVertexUvs[0].push([new THREE.Vector2(0,0),new THREE.Vector2(0,1),new THREE.Vector2(1,1)])}}if(a.joint)if(g=[0,0,0,0],h=[0,0,0,0],f=a.jointPerVertex,4<f)for(console.warn("SEA3D: Joint Per Vertex can not be greater than 4 (currently "+
a.jointPerVertex+"). Using compression for joints.\nTip: Use SEA3D Studio for automatic compression."),d=0;d<a.joint.length;d+=f){k=[0];for(c=1;c<f;c++)l=a.weight[d+c],l>a.weight[d+k[0]]?k.unshift(c):k.push(c);l=(1-(a.weight[d+k[0]]+a.weight[d+k[1]]+a.weight[d+k[2]]+a.weight[d+k[3]]))/4;for(c=0;4>c;c++)b=k[c],g[c]=a.joint[d+b],h[c]=a.weight[d+b]+l;e.skinIndices.push(new THREE.Vector4(g[0],g[1],g[2],g[3]));e.skinWeights.push(new THREE.Vector4(h[0],h[1],h[2],h[3]))}else for(d=0;d<a.joint.length;d+=
f){for(c=0;c<f;c++)g[c]=a.joint[d+c],h[c]=a.weight[d+c];e.skinIndices.push(new THREE.Vector4(g[0],g[1],g[2],g[3]));e.skinWeights.push(new THREE.Vector4(h[0],h[1],h[2],h[3]))}a.normal||(e.computeFaceNormals(),e.computeVertexNormals());this.config.tangent&&!a.tangent&&e.computeTangents();this.config.bounding&&(e.computeBoundingBox(),e.computeBoundingSphere());e.name=a.name;a.tag=e};
THREE.SEA3D.prototype.readDummy=function(a){var b=new THREE.BoxGeometry(a.width,a.height,a.depth,1,1,1),c=new THREE.MeshBasicMaterial({wireframe:!0,color:THREE.SEA3D.HELPER_COLOR}),b=new THREE.Mesh(b,c);b.name=a.name;this.dummys=this.dummys||[];this.dummys.push(this.objects["dmy/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.applyDefaultAnimation(a,THREE.SEA3D.Object3DAnimator)};
THREE.SEA3D.prototype.readLine=function(a){var b=new THREE.Geometry;b.vertices=this.config.flip?this.vectorToVector3Inv(a.vertex):this.vectorToVector3(a.vertex);a.closed&&b.vertices.push(b.vertices[0]);b=new THREE.Line(b,new THREE.LineBasicMaterial({color:THREE.SEA3D.HELPER_COLOR,linewidth:3}));b.name=a.name;this.lines=this.lines||[];this.lines.push(this.objects["line/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.applyDefaultAnimation(a,THREE.SEA3D.Object3DAnimator)};
THREE.SEA3D.prototype.readContainer3D=function(a){var b=new THREE.Object3D;this.containers=this.containers||[];this.containers.push(this.objects["c3d/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.applyDefaultAnimation(a,THREE.SEA3D.Object3DAnimator)};
THREE.SEA3D.prototype.readMesh2D=function(a){var b;a.material&&(a.material.tag.sprite?b=a.material.tag.sprite:(b=a.material.tag.sprite=new THREE.SpriteMaterial,b.map=a.material.tag.map,b.map.flipY=!0,b.color=a.material.tag.emissive,b.opacity=a.material.tag.opacity,b.blending=a.material.tag.blending));b=new THREE.Sprite(b);b.name=a.name;this.sprites=this.sprites||[];this.sprites.push(this.objects["m2d/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);b.scale.set(a.width,a.height,
1)};
THREE.SEA3D.prototype.readMesh=function(a){for(var b=a.geometry.tag,c,d,e,g,h=0,f=a.modifiers?a.modifiers.length:0;h<f;h++){var k=a.modifiers[h];switch(k.type){case SEA3D.Skeleton.prototype.type:c=k;b.bones=c.tag;break;case SEA3D.Morph.prototype.type:g=k}}h=0;for(f=a.animations?a.animations.length:0;h<f;h++)switch(k=a.animations[h],k.tag.type){case SEA3D.SkeletonAnimation.prototype.type:e=k.tag,b.animations=this.getSkeletonAnimation(e,c)}if(a.material)if(1<a.material.length){d=[];for(h=0;h<a.material.length;h++)d[h]=a.material[h].tag,
d[h].skinning=null!=c,d[h].morphTargets=null!=g,d[h].morphNormals=!1,d[h].vertexColors=a.geometry.color?THREE.VertexColors:THREE.NoColors;d=new THREE.MeshFaceMaterial(d)}else d=a.material[0].tag,d.skinning=null!=c,d.morphTargets=null!=g,d.morphNormals=!1,d.vertexColors=a.geometry.color?THREE.VertexColors:THREE.NoColors;g&&(b.morphTargets=this.getMorpher(g,a.geometry));c?(c=new THREE.SkinnedMesh(b,d,!1),e&&(c.setAnimations(b.animations),this.config.autoPlay&&c.play(c.animations[0].name))):c=new THREE.Mesh(b,
d);c.name=a.name;c.castShadow=a.castShadows;c.receiveShadow=a.material?a.material[0].receiveShadows:!0;this.meshes=this.meshes||[];this.meshes.push(this.objects["m3d/"+a.name]=a.tag=c);this.addSceneObject(a);this.updateTransform(c,a);this.applyDefaultAnimation(a,THREE.SEA3D.Object3DAnimator)};
THREE.SEA3D.prototype.readSoundPoint=function(a){var b=new THREE.Sound3D(a.sound.tag,a.volume,a.distance);a.autoPlay&&(b.loop=!0,b.play());b.name=a.name;this.sounds3d=this.sounds3d||[];this.sounds3d.push(this.objects["sn3d/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.applyDefaultAnimation(a,THREE.SEA3D.Object3DAnimator)};
THREE.SEA3D.prototype.readCubeRender=function(a){var b=new THREE.CubeCamera(.1,5E3,THREE.SEA3D.TEXTURE_SIZE);b.renderTarget.cubeCamera=b;this.cubeRenderers=this.cubeRenderers||[];this.cubeRenderers.push(this.objects["rttc/"+a.name]=a.tag=b.renderTarget);this.addSceneObject(a);this.updateTransform(b,a);this.applyDefaultAnimation(a,THREE.SEA3D.Object3DAnimator)};
THREE.SEA3D.prototype.readImage=function(a){var b=new Image,c=new THREE.Texture,d=this;c.name=a.name;c.wrapS=c.wrapT=THREE.RepeatWrapping;c.flipY=!1;b.onload=function(){if(!d.isPowerOfTwo(b.width)||!d.isPowerOfTwo(b.height)){var a=d.nearestPowerOfTwo(b.width),g=d.nearestPowerOfTwo(b.height),h=document.createElement("canvas");h.width=a;h.height=g;h.getContext("2d").drawImage(b,0,0,a,g);b=h}c.image=b;c.needsUpdate=!0};b.src=this.bufferToTexture(a.data.buffer);this.textures=this.textures||[];this.textures.push(this.objects["tex/"+
a.name]=a.tag=c)};THREE.SEA3D.prototype.readCubeMap=function(a){var b=[],c=new THREE.Texture,d=[];d[0]=a.faces[1];d[1]=a.faces[0];d[2]=a.faces[3];d[3]=a.faces[2];d[4]=a.faces[5];d[5]=a.faces[4];b.loadedCount=0;c.name=a.name;c.image=b;c.flipY=!1;for(var e=0,g=d.length;e<g;++e){var h=new Image;b[e]=h;h.onload=function(){6==++b.loadedCount&&(c.needsUpdate=!0)};h.src=this.bufferToTexture(d[e].buffer)}this.cubmaps=this.cubmaps||[];this.cubmaps.push(this.objects["cmap/"+a.name]=a.tag=c)};
THREE.SEA3D.prototype.readSound=function(a){var b=this.bufferToSound(a.data.buffer);this.sounds=this.sounds||[];this.sounds.push(this.objects["snd/"+a.name]=a.tag=b)};THREE.SEA3D.prototype.readTextureURL=function(a){var b=THREE.ImageUtils.loadTexture(a.url);b.name=a.name;b.wrapS=b.wrapT=THREE.RepeatWrapping;b.flipY=!1;this.textures=this.textures||[];this.textures.push(this.objects["tex/"+a.name]=a.tag=b)};
THREE.SEA3D.prototype.blendMode={normal:THREE.NormalBlending,add:THREE.AdditiveBlending,subtract:THREE.SubtractiveBlending,multiply:THREE.MultiplyBlending,screen:THREE.AdditiveBlending};
THREE.SEA3D.prototype.materialTechnique=function(){var a={};a[SEA3D.Material.DEFAULT]=function(a,c){c.emissive.setHex(a.ambientColor);c.color.setHex(a.diffuseColor);c.specular.setHex(this.scaleColor(a.specularColor,a.specular));c.shininess=a.gloss};a[SEA3D.Material.DIFFUSE_MAP]=function(a,c){c.map=a.texture.tag;c.transparent=a.texture.transparent};a[SEA3D.Material.SPECULAR_MAP]=function(a,c){c.specularMap=a.texture.tag};a[SEA3D.Material.NORMAL_MAP]=function(a,c){c.normalMap=a.texture.tag};a[SEA3D.Material.REFLECTION]=
a[SEA3D.Material.FRESNEL_REFLECTION]=function(a,c){c.envMap=a.texture.tag;c.envMap.mapping=THREE.CubeReflectionMapping;c.combine=THREE.MixOperation;c.reflectivity=a.alpha};a[SEA3D.Material.REFLECTION_SPHERICAL]=function(a,c){c.envMap=a.texture.tag;c.envMap.mapping=THREE.SphericalReflectionMapping;c.combine=THREE.MixOperation;c.reflectivity=a.alpha};a[SEA3D.Material.REFRACTION_MAP]=function(a,c){c.envMap=a.texture.tag;c.envMap.mapping=THREE.CubeRefractionMapping();c.refractionRatio=a.ior;c.reflectivity=
a.alpha};a[SEA3D.Material.LIGHT_MAP]=function(a,c){c.lightMap=a.texture.tag};return a}();
THREE.SEA3D.prototype.readMaterial=function(a){var b=new THREE.MeshPhongMaterial;b.emissiveToAmbientColor=!0;b.name=a.name;b.side=a.bothSides?THREE.DoubleSide:THREE.FrontSide;b.shading=a.smooth?THREE.SmoothShading:THREE.FlatShading;"normal"!=a.blendMode&&this.blendMode[a.blendMode]&&(b.blending=this.blendMode[a.blendMode]);if(1>a.alpha||b.blending>THREE.NormalBlending)b.opacity=a.alpha,b.transparent=!0;for(var c=0;c<a.technique.length;c++){var d=a.technique[c];this.materialTechnique[d.kind]&&this.materialTechnique[d.kind].call(this,
d,b)}b.transparent&&(b.alphaTest=a.alphaThreshold);this.materials=this.materials||[];this.materials.push(this.objects["mat/"+a.name]=a.tag=b)};
THREE.SEA3D.prototype.readPointLight=function(a){var b=new THREE.PointLight(a.color,a.multiplier*this.config.multiplier);b.name=a.name;a.shadow&&this.setShadowMap(b,a.shadow.opacity);this.lights=this.lights||[];this.lights.push(this.objects["lht/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.applyDefaultAnimation(a,THREE.SEA3D.LightAnimator);this.updateScene()};
THREE.SEA3D.prototype.readDirectionalLight=function(a){var b=new THREE.DirectionalLight(a.color,a.multiplier*this.config.multiplier);b.name=a.name;a.shadow&&this.setShadowMap(b,a.shadow.opacity);this.lights=this.lights||[];this.lights.push(this.objects["lht/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.applyDefaultAnimation(a,THREE.SEA3D.LightAnimator);this.updateScene()};
THREE.SEA3D.prototype.readCamera=function(a){var b=new THREE.PerspectiveCamera(a.fov);b.name=a.name;this.cameras=this.camera||[];this.cameras.push(this.objects["cam/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.applyDefaultAnimation(a,THREE.SEA3D.CameraAnimator)};
THREE.SEA3D.prototype.readSkeleton=function(a){for(var b=[],c=new THREE.Matrix4,d=new THREE.Matrix4,e=new THREE.Matrix4,g=new THREE.Vector3,h=new THREE.Quaternion,f=0;f<a.joint.length;f++){var k=a.joint[f];c.elements=k.inverseBindMatrix;d.getInverse(c);this.flipMatrix(d);-1<k.parentIndex&&(c.elements=a.joint[k.parentIndex].inverseBindMatrix,e.getInverse(c),this.flipMatrix(e),e.getInverse(e),d.multiplyMatrices(e,d));g.setFromMatrixPosition(d);h.setFromRotationMatrix(d);b[f]={name:k.name,pos:[g.x,g.y,
g.z],rotq:[h.x,h.y,h.z,h.w],parent:k.parentIndex}}a.tag=b};THREE.SEA3D.prototype.readSkeletonLocal=function(a){for(var b=[],c=0;c<a.joint.length;c++){var d=a.joint[c];b[c]={name:d.name,pos:[d.x,d.y,d.z],rotq:[d.qx,d.qy,d.qz,d.qw],parent:d.parentIndex}}a.tag=b};THREE.SEA3D.prototype.readJointObject=function(a){var b=a.target.tag.skeleton.bones[a.joint];this.joints=this.joints||[];this.joints.push(this.objects["jnt/"+a.name]=a.tag=b)};
THREE.SEA3D.prototype.getSkeletonAnimation=function(a,b){if(a.tag)return a.tag;for(var c=[],d=a.frameRate/1E3,e=[1,1,1],g=new THREE.Matrix4,h=0;h<a.sequence.length;h++){for(var f=a.sequence[h],k=f.start,l=k+f.count,f={name:a.name+"/"+f.name,repeat:f.repeat,fps:a.frameRate,JIT:0,length:d*(f.count-1),hierarchy:[]},m=a.pose[0].length,t=0;t<m;t++){for(var v=b.joint[t],w={parent:v.parentIndex,keys:[]},z=w.keys,B=0,r=k;r<l;r++){var p=a.pose[r][t],n=THREE.SEA3D.BUFFER2.makeRotationFromQuaternion(new THREE.Quaternion(p.qx,
p.qy,p.qz,p.qw));n.setPosition(new THREE.Vector3(p.x,p.y,p.z));-1<v.parentIndex?(g.elements=b.joint[v.parentIndex].inverseBindMatrix,p=THREE.SEA3D.BUFFER3.getInverse(g),n.multiplyMatrices(p,n),this.flipMatrix(n),p.getInverse(g),this.flipMatrix(p),p.getInverse(p),n.multiplyMatrices(p,n)):this.flipMatrix(n);p=THREE.SEA3D.VECBUF0.setFromMatrixPosition(n);n=THREE.SEA3D.QUABUF0.setFromRotationMatrix(n);z.push({time:B,pos:[p.x,p.y,p.z],rot:[n.x,n.y,n.z,n.w],scl:e});B+=d}f.hierarchy[t]=w}c.push(f)}return a.tag=
c};THREE.SEA3D.prototype.getMorpher=function(a,b){for(var c=[],d=this.config.flip?-1:1,e=0;e<a.node.length;e++){for(var g=a.node[e],h=[],f=0,k=0;f<b.vertex.length;)h[k++]=new THREE.Vector3(b.vertex[f]+g.vertex[f++],b.vertex[f]+g.vertex[f++],(b.vertex[f]+g.vertex[f++])*d);c[g.name]=e;c[e]={name:g.name,vertices:h}}return c};THREE.SEA3D.Event={LOAD_PROGRESS:"sea3d_progress",DOWNLOAD_PROGRESS:"sea3d_download",COMPLETE:"sea3d_complete",OBJECT_COMPLETE:"sea3d_object",ERROR:"sea3d_error"};
THREE.SEA3D.prototype.onProgress=null;THREE.SEA3D.prototype.onComplete=function(a){a.file=this.scope;a.type=THREE.SEA3D.Event.COMPLETE;a.file.dispatchEvent(a)};THREE.SEA3D.prototype.onLoadProgress=function(a){a.file=this.scope;a.type=THREE.SEA3D.Event.LOAD_PROGRESS;a.file.dispatchEvent(a);if(a.file.onProgress)a.file.onProgress(a)};THREE.SEA3D.prototype.onDownloadProgress=function(a){a.file=this.scope;a.type=THREE.SEA3D.Event.DOWNLOAD_PROGRESS;a.file.dispatchEvent(a);if(a.file.onProgress)a.file.onProgress(a)};
THREE.SEA3D.prototype.onCompleteObject=function(a){a.file=this.scope;a.type=THREE.SEA3D.Event.OBJECT_COMPLETE;a.file.dispatchEvent(a)};THREE.SEA3D.prototype.onError=function(a){a.file=this.scope;a.type=THREE.SEA3D.Event.ERROR;a.file.dispatchEvent(a)};THREE.SEA3D.prototype.load=function(a){this.loadBytes();this.file.load(a)};
THREE.SEA3D.prototype.loadBytes=function(a){this.file=new SEA3D.File(a);this.file.scope=this;this.file.onComplete=this.onComplete;this.file.onProgress=this.onLoadProgress;this.file.onCompleteObject=this.onCompleteObject;this.file.onDownloadProgress=this.onDownloadProgress;this.file.onError=this.onError;switch(this.config.parser){case THREE.SEA3D.AUTO:this.file.typeRead[SEA3D.Geometry.prototype.type]=this.file.typeRead[SEA3D.GeometryDelta.prototype.type]=this.readGeometrySwitch;break;case THREE.SEA3D.BUFFER:this.file.typeRead[SEA3D.Geometry.prototype.type]=
this.file.typeRead[SEA3D.GeometryDelta.prototype.type]=this.readGeometryBuffer;break;default:this.file.typeRead[SEA3D.Geometry.prototype.type]=this.file.typeRead[SEA3D.GeometryDelta.prototype.type]=this.readGeometry}this.file.typeRead[SEA3D.Mesh.prototype.type]=this.readMesh;this.file.typeRead[SEA3D.Mesh2D.prototype.type]=this.readMesh2D;this.file.typeRead[SEA3D.Container3D.prototype.type]=this.readContainer3D;this.file.typeRead[SEA3D.Dummy.prototype.type]=this.readDummy;this.file.typeRead[SEA3D.Line.prototype.type]=
this.readLine;this.file.typeRead[SEA3D.Material.prototype.type]=this.readMaterial;this.file.typeRead[SEA3D.PointLight.prototype.type]=this.readPointLight;this.file.typeRead[SEA3D.DirectionalLight.prototype.type]=this.readDirectionalLight;this.file.typeRead[SEA3D.Camera.prototype.type]=this.readCamera;this.file.typeRead[SEA3D.Skeleton.prototype.type]=this.readSkeleton;this.file.typeRead[SEA3D.SkeletonLocal.prototype.type]=this.readSkeletonLocal;this.file.typeRead[SEA3D.JointObject.prototype.type]=
this.readJointObject;this.file.typeRead[SEA3D.CubeMap.prototype.type]=this.readCubeMap;this.file.typeRead[SEA3D.CubeRender.prototype.type]=this.readCubeRender;this.file.typeRead[SEA3D.Animation.prototype.type]=this.readAnimation;this.file.typeRead[SEA3D.SoundPoint.prototype.type]=this.readSoundPoint;this.file.typeRead[SEA3D.TextureURL.prototype.type]=this.readTextureURL;this.file.typeRead[SEA3D.JPEG.prototype.type]=this.readImage;this.file.typeRead[SEA3D.JPEG_XR.prototype.type]=this.readImage;this.file.typeRead[SEA3D.PNG.prototype.type]=
this.readImage;this.file.typeRead[SEA3D.GIF.prototype.type]=this.readImage;this.file.typeRead[SEA3D.MP3.prototype.type]=this.readSound;a&&this.file.read()};